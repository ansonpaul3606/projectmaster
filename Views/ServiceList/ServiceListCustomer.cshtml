
@model PerfectWebERP.Models.ServiceListModel.ServiceListView

<div class="container-fluid">
    <div class="row">
        <div class="col-lg-12" id="jq_ServiceIndex_formContainer">
            <div class="card ">

                @*<div class="card-header">
                    <h4 class="card-title col-12">Purchase<span class="badge light badge-success float-right" perfect-class="formTitle">ADD</span></h4>
                </div>*@

                <div class="card-body px-2">
                    @*<form id="" class="form-valide" perfect-class="form" action="#" method="post" perfect-onFormSuccess="">*@
                    @*<form id="" class="form-valide" perfect-class="form-Assign" action="#" method="post" perfect-onFormSuccess="">*@
                    <div class="col-md-12 jq_service_commonForm_div">
                        @Html.AntiForgeryToken()



                        <div class="col-xl-12 border p-3" style="border-color:black">
                            <div class="row">
                                <div class="col-xl-6">
                                </div>
                                <div class="col-xl-6">
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-xl-6">
                                    <div class="form-group" perfect-class="formGroup">
                                        @*<label class="col-lg-6 col-form-label">
                        <span perfect-class="formGroupLabel">Ticket Details</span>*@
                                        <h4 class='text-primary mb-4'>Ticket Details</h4>
                                        <hr />
                                        @*</label>*@

                                    </div>
                                </div>
                                <div class="col-xl-6">
                                    <div class="form-group" perfect-class="formGroup">
                                        @*<label class="col-lg-6 col-form-label">
                        <span perfect-class="formGroupLabel">Ticket Details</span>*@
                                        <h4 class='text-primary mb-4'>Customer Details</h4>
                                        <hr />
                                        @*</label>*@

                                    </div>
                                </div>
                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-3 col-form-label">
                                            <span perfect-class="formGroupLabel" class="font-weight-bold">Ticket Number</span>

                                        </label>
                                        <div class="col-lg-9">
                                            <label class="col-lg-6 col-form-label" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input">@Model.TicketNo</label>

                                        </div>
                                    </div>


                                </div>
                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-3 col-form-label">
                                            <span perfect-class="formGroupLabel" class="font-weight-bold">Customer Name:</span>

                                        </label>
                                        <div class="col-lg-9">
                                            <label class="col-lg-6 col-form-label" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input">@Model.CusName</label>
                                            @*<input type="text" class="form-control perfectValidate_mobile" placeholder="" name="CustomerMobile" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />*@
                                        </div>
                                    </div>


                                </div>

                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-3 col-form-label">
                                            <span perfect-class="formGroupLabel" class="font-weight-bold">Registerd On</span>

                                        </label>
                                        <div class="col-lg-9">
                                            <label class="col-lg-6 col-form-label" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input">@Model.RegisteredOn</label>

                                        </div>
                                    </div>


                                </div>
                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-3 col-form-label">
                                            <span perfect-class="formGroupLabel" class="font-weight-bold">Mobile:</span>

                                        </label>
                                        <div class="col-lg-9">
                                            <label class="col-lg-6 col-form-label" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input">@Model.Mobile</label>
                                            @*<input type="text" class="form-control perfectValidate_mobile" placeholder="" name="CustomerMobile" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />*@
                                        </div>
                                    </div>


                                </div>
                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-3 col-form-label">
                                            <span perfect-class="formGroupLabel" class="font-weight-bold">Visited On:</span>

                                        </label>
                                        <div class="col-lg-9">
                                            <label class="col-lg-6 col-form-label" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input">@Model.VisitedDate</label>
                                            @*<input type="text" class="form-control perfectValidate_mobile" placeholder="" name="CustomerMobile" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />*@
                                        </div>
                                    </div>


                                </div>
                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-3 col-form-label">
                                            <span perfect-class="formGroupLabel" class="font-weight-bold">Address</span>

                                        </label>
                                        <div class="col-lg-9">
                                            <label class="col-lg-6 col-form-label" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input">@Model.Address</label>


                                            @*<input type="text" class="form-control perfectValidate_mobile" placeholder="" name="CustomerMobile" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />*@
                                        </div>
                                    </div>


                                </div>


                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-4 col-form-label">
                                            <span perfect-class="formGroupLabel"></span>

                                        </label>
                                        <div class="col-lg-8">
                                            <label class="col-lg-6 col-form-label" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input"></label>
                                            @*<input type="text" class="form-control perfectValidate_mobile" placeholder="" name="CustomerMobile" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />*@
                                        </div>
                                    </div>


                                </div>

                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-4 col-form-label">
                                            <span perfect-class="formGroupLabel" class="font-weight-bold">Location:</span>

                                        </label>
                                        <div class="col-lg-9">
                                            <label class="col-lg-6 col-form-label" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input">@Model.Location</label>
                                            @*<input type="text" class="form-control perfectValidate_mobile" placeholder="" name="CustomerMobile" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />*@
                                        </div>
                                    </div>


                                </div>




                            </div>


                        </div>
                        <form id="" class="form-valide" perfect-class="CUstomer" action="#" method="post" perfect-onFormSuccess="">
                            <div class="row">
                                <div class="col-xl-6">
                                    <div class="form-group" perfect-class="formGroup">
                                        <label class="col-lg-4 col-form-label">


                                        </label>
                                        <div class="col-lg-9">
                                            <input type="hidden" name="F_Customer" value="@Model.FK_Customer" Perfect-class="formGroupControl" />
                                            <button id="btnStart" type="button" class="btn btn-primary" name="Start" data-toggle="tooltip" data-placement="top" data-original-title="Start" perfect-css="button" onclick="fn_showFilter()"><i class="fa fa-clock-o"></i></button>
                                            @*<button id="addcompany-jq-addnewuser" type="button" class="btn tp-btn-light btn-warning" name="Start" data-toggle="tooltip" data-placement="top" data-original-title="Customer Details" perfect-css="button" onclick="fn_showFilter()">Customer Details</button>*@
                                            <button id="addcompany-jq-addnewuser" type="button" class="btn btn-primary" name="Start" data-toggle="tooltip" onclick="GetCustomerDetails(this,@Model.FK_Customer)" data-placement="top" data-original-title="Customer Details" perfect-css="button"><i class="fa fa-user"></i></button>

                                        </div>
                                    </div>


                                </div>
                            </div>
                            <div class="modal fade bd-service-modal-smcustomer" tabindex="-1" role="dialog" style="display: none;" aria-hidden="true">
                                <div class="modal-dialog modal-xl">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Customer Details</h5>
                                            <button type="button" class="close" data-dismiss="modal">
                                                <span>×</span>
                                            </button>
                                        </div>

                                        <div class="modal-body" perfect-class="formGroup" style="max-height: calc(100vh - 200px); overflow-y: auto;">

                                            <div class="form-row" id="TopDetails">

                                            </div>
                                            <div class="form-row">
                                                <div class="col-lg-12">
                                                    <div class="card">

                                                        <div class="card-body">
                                                            <div class="table-responsive">
                                                                <table class="table table-responsive-sm" id="Customer">
                                                                    <thead class="bg-primary text-white">
                                                                        <tr>
                                                                            <th>SI.No.</th>
                                                                            <th>TicketNo</th>
                                                                            <th>Ticket Date</th>
                                                                            <th>FollowUp Date</th>
                                                                            <th>Product</th>
                                                                            <th>Complaint</th>
                                                                            <th>Description</th>
                                                                            <th>Status</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="CustomerTbody">
                                                                        <tr id="0">
                                                                            <td colspan="4" style="text-align:center;">No Records...</td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- /# card -->
                                                </div>

                                            </div>

                                            <input type="hidden" name="FK_Customerserviceregister" />

                                        </div>


                                    </div>
                                </div>
                            </div>
                        </form>
                        <div class="card-body jq_Service_body ">
                            <form id="" class="form-valide" perfect-class="form" action="#" method="post" perfect-onFormSuccess="">
                                <div class="ServiceformSesction">
                                    @Html.AntiForgeryToken()
                                    <div class="row">
                                        <input type="hidden" class="form-control" placeholder="" name="FusCustomer" value="@Model.FK_Customer" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />
                                        <input type="hidden" class="form-control" placeholder="" name="FEmployee" value="@Model.FK_Employee" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />
                                        <input type="hidden" class="form-control" placeholder="" name="FK_Customerserviceregister" value="@Model.FK_Customerserviceregister" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />
                                        <div class="col-xl-4 mb-3">
                                            <div class="example">
                                                <p class="mb-1">From Date &nbsp;<span class="text-danger">*</span></p>

                                                <input type="date" class="form-control perfectValidate_date Servicefromdate" id="Servicefromdate" name="Servicefromdate" perfect-class="formGroupControl" perfect-ctype="date" perfect-css="date">
                                            </div>
                                        </div>

                                        <div class="col-xl-2  mb-3">
                                            <div class="example">
                                                <p class="mb-1">From Time</p>
                                                <input type="time" class="form-control" placeholder="" name="Servicefromtime" value=now perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />
                                            </div>
                                        </div>
                                        <div class="col-xl-2 mb-3">
                                            <div class="example">
                                                <p class="mb-1">To Time</p>
                                                <input type="time" class="form-control" placeholder="" name="Servicetotime" value=now perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />
                                            </div>
                                        </div>

                                        <div class="col-xl-2 mb-3">
                                            <div class="example">
                                                <p class="mb-1">Attended Mode</p>
                                                <select class="form-control perfectValidate_string_nm" name="AttendedMode" perfect-class="formGroupControl" perfect-ctype="select" perfect-css="select">
                                                    <option value="0">Please select</option>
                                                    @if (!(Model.AtMode is null))
                                                    {
                                                        foreach (var Mode in Model.AtMode)
                                                        {
                                                            <option value="@Mode.ID_ActionType">@Mode.ActnTypeName</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                        </div>




                                    </div>
                                </div>
                                <div class="row">

                                    <div class="row table-responsive">
                                        <table id="GridData" class="table  mb-0  table-striped  text-black">
                                            <thead class="thead-primary">
                                                <tr>
                                                    <th class="t-head" style="display:none">
                                                        ID_Product
                                                    </th>

                                                    <th class="t-head">
                                                        Product
                                                    </th>
                                                    <th class="t-head">
                                                        Complaint
                                                    </th>
                                                    <th class="t-head">
                                                        Description
                                                    </th>
                                                    <th class="t-head">

                                                    </th>
                                                    <th class="t-head">

                                                    </th>
                                                    <th class="t-head">

                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @if (Model != null)
                                                {
                                                    foreach (var item in Model.EmployeeDetails)
                                                    {
                                                        <tr>
                                                            <td style="display:none">
                                                                @Html.DisplayFor(model => item.ID_Product)
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(model => item.Product)
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(model => item.ProductComplaint)
                                                            </td>
                                                            <td>
                                                                @Html.DisplayFor(model => item.ProductDescription)
                                                            </td>

                                                            <td>
                                                                <button type="button" name="PServices" data-toggle="tooltip" data-placement="top" data-original-title="Services" class="btn btn-outline-primary" onclick="GetServices(this,@item.ID_Product)"><i class="fa fa-wrench"></i></button>

                                                            </td>
                                                            <td>
                                                                <button type="button" name="ProductDetails" data-toggle="tooltip" data-placement="top" data-original-title="Product Details" class="btn btn-outline-primary" onclick="GetProserDetails(this,@item.ID_Product)"><i class="fa fa-product-hunt"></i></button>

                                                            </td>
                                                            <td>
                                                                <button type="button" name="ProductHistory" class="btn btn-outline-primary" data-toggle="tooltip" data-placement="top" data-original-title="Product History" onclick="GetProductDetails(this,@item.ID_Product)"><i class="fa fa-history"></i></button>

                                                            </td>
                                                            <td>
                                                                <button type="button" name="ProductDetails" class="btn btn-outline-primary" data-toggle="tooltip" data-placement="top" data-original-title="Product Details" onclick="GetProductData(this,@item.ID_Product)"><i class="fa fa-history"></i></button>

                                                            </td>

                                                        </tr>
                                                    }
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                            </form>


                        </div>
                       
                        <form id="" class="form-valide" perfect-class="Assign" action="#" method="post" perfect-onFormSuccess="">
                            <div class="modal fade bd-service-modal-sm" tabindex="-1" role="dialog" style="display: none;" aria-hidden="true">
                                <div class="modal-dialog modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Product Details</h5>
                                            <button type="button" class="close" data-dismiss="modal">
                                                <span>×</span>
                                            </button>
                                        </div>

                                        <div class="modal-body" perfect-class="formGroup" style="max-height: calc(100vh - 200px); overflow-y: auto;">

                                            <div class="form-row" id="TopDetails">

                                            </div>
                                            <div class="form-row">
                                                <div class="col-lg-12">
                                                    <div class="card">
                                                        @*<div class="card-header">
                                            <h4 class="card-title">Product Details</h4>
                                        </div>*@
                                                        <div class="card-body">
                                                            <div class="table-responsive">
                                                                <table class="table table-responsive-sm" id="Product">
                                                                    <thead class="bg-primary text-white">
                                                                        <tr>
                                                                            <th>SI.No.</th>
                                                                            <th>Product</th>
                                                                            <th>Complaint</th>
                                                                            <th>Description</th>
                                                                            <th>Status</th>
                                                                            <th>Warrenty</th>
                                                                            <th>Warrenty Date</th>
                                                                            <th>Model No</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="ProductTbody">
                                                                        <tr id="0">
                                                                            <td colspan="4" style="text-align:center;">No Records...</td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- /# card -->
                                                </div>

                                            </div>

                                            <input type="hidden" name="FK_Customerserviceregister" />

                                        </div>
                                        @*<div class="modal-footer">
                            <button type="button" id="btnUpdate" onclick="fn_SaveCustomerServiceAssign(this);" class="btn btn-primary">Update</button>
                            <button type="button" id="btnSave" onclick="fn_SaveCustomerServiceAssign(this);" class="btn btn-primary">Save</button>
                            <button type="button" class="btn btn-danger light" data-dismiss="modal">Cancel</button>
                        </div>*@

                                    </div>
                                </div>
                            </div>

                            <div class="modal fade bd-Productservice-modal-sm" tabindex="-1" role="dialog" style="display: none;" aria-hidden="true">
                                <div class="modal-dialog modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Service Details</h5>
                                            <button type="button" class="close" data-dismiss="modal">
                                                <span>×</span>
                                            </button>
                                        </div>

                                        <div class="modal-body" perfect-class="formGroup" style="max-height: calc(100vh - 200px); overflow-y: auto;">

                                            <div class="form-row" id="TopDetails">

                                            </div>
                                            <div class="form-row">
                                                <div class="col-lg-12">
                                                    <div class="card">
                                                        <div class="card-body">
                                                            <div class="table-responsive">
                                                                <table class="table table-hover table-responsive-sm table-striped  text-black" id="ProductServices">
                                                                    <thead class="bg-primary text-white">
                                                                        <tr>
                                                                            @*<th></th>*@
                                                                            <th style="display:none"> </th>
                                                                            <th style="display:none"></th>
                                                                            <th></th>
                                                                            <th>Services</th>
                                                                            <th>Amount</th>
                                                                            <th>Remarks</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="ProductServiceTbody">
                                                                        <tr id="0">
                                                                            <td colspan="4" style="text-align:center;">No Records...</td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                                <div class="modal-footer">

                                                                    <button type="button" id="btnSaveServices" onclick="BindServiceAmount(this)" class="btn btn-primary">Save</button>

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- /# card -->
                                                </div>

                                            </div>

                                            <input type="hidden" name="FK_Customerserviceregister" />

                                        </div>

                                    </div>
                                </div>
                            </div>

                            <div class="modal fade bd-ProductDetails-modal-sm" tabindex="-1" role="dialog" style="display: none;" aria-hidden="true">
                                <div class="modal-dialog modal-xl">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Product Details</h5>
                                            <button type="button" class="close" data-dismiss="modal">
                                                <span>×</span>
                                            </button>
                                        </div>

                                        <div class="modal-body" perfect-class="formGroup" style="max-height: calc(100vh - 200px); overflow-y: auto;">

                                            <div class="form-row" id="TopDetails">

                                            </div>
                                            <div class="form-row">
                                                <div class="col-lg-12">
                                                    <div class="card">
                                                        @*<div class="card-header">
                                            <h4 class="card-title">Product Details</h4>
                                        </div>*@
                                                        <div class="card-body">
                                                            <div class="table-responsive">
                                                                <table class="table table-hover table-responsive-sm table-striped  text-black" id="ProductDetails">
                                                                    <thead class="bg-primary text-white">
                                                                        <tr>
                                                                            @*<th></th>*@
                                                                            <th></th>
                                                                            <th>Product</th>
                                                                            <th>Quantity</th>
                                                                            <th>Product Amount</th>
                                                                            <th>Change Mode</th>
                                                                            <th>Replace Amount</th>
                                                                            <th>Serial No</th>

                                                                            <th>Remarks</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody id="ProductDetailsTbody">
                                                                        <tr id="0">
                                                                            <td colspan="4" style="text-align:center;">No Records...</td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                                <div class="modal-footer">
                                                                 
                                                                    <button type="button" id="btnSaveProductDetails" onclick="BindProductAmount(this)" class="btn btn-primary">Save</button>
                                                                  
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- /# card -->
                                                </div>

                                            </div>

                                            <input type="hidden" name="FK_Customerserviceregister" />

                                        </div>
                                        @*<div class="modal-footer">
                            <button type="button" id="btnUpdate" onclick="fn_SaveCustomerServiceAssign(this);" class="btn btn-primary">Update</button>
                            <button type="button" id="btnSave" onclick="fn_SaveCustomerServiceAssign(this);" class="btn btn-primary">Save</button>
                            <button type="button" class="btn btn-danger light" data-dismiss="modal">Cancel</button>
                        </div>*@

                                    </div>
                                </div>
                            </div>

                            <div class="modal fade bd-ProductHistory-modal-sm" tabindex="-1" role="dialog" style="display: none;" aria-hidden="true">
                                <div class="modal-dialog modal-xl">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Product Details</h5>
                                            <button type="button" class="close" data-dismiss="modal">
                                                <span>×</span>
                                            </button>
                                        </div>

                                        <div class="modal-body" perfect-class="formGroup" style="max-height: calc(100vh - 200px); overflow-y: auto;">

                                            <div class="form-row" id="TopDetails">

                                            </div>
                                            <div class="form-row">
                                                <div class="col-lg-12">
                                                    <div class="card">
                                                        @*<div class="card-header">
                                            <h4 class="card-title">Product Details</h4>
                                        </div>*@
                                                        <div class="card-body">
                                                            <div class="default-tab">
                                                                <ul class="nav nav-tabs" role="tablist">
                                                                    <li class="nav-item">
                                                                        <a class="nav-link active" data-toggle="tab" href="#home"><i class="fa fa-product-hunt"></i>Product Details</a>
                                                                    </li>
                                                                    <li class="nav-item">
                                                                        <a class="nav-link" data-toggle="tab" href="#profile"><i class="la la-user mr-2"></i>Images </a>
                                                                    </li>
                                                                    <li class="nav-item">
                                                                        <a class="nav-link" data-toggle="tab" href="#UploadImages"><i class="la la-user mr-2"></i>Upload Images </a>
                                                                    </li>
                                                                    <li class="nav-item">
                                                                        <a class="nav-link" data-toggle="tab" href="#UploadDocuments"><i class="la la-user mr-2"></i>Upload Documents </a>
                                                                    </li>
                                                                </ul>
                                                            </div>
                                                            <div class="tab-content">
                                                                <div class="tab-pane fade show active" id="home" role="tabpanel">
                                                                    <div class="pt-4">
                                                                        <table class="table table-responsive-sm" id="Product">
                                                                            <thead class="bg-primary text-white">
                                                                                <tr>
                                                                                    <th>SI.No.</th>
                                                                                    <th>Product</th>
                                                                                    <th>Complaint</th>
                                                                                    <th>Description</th>
                                                                                    <th>Status</th>
                                                                                    <th>Warrenty</th>
                                                                                    <th>Warrenty Date</th>
                                                                                    <th>Model No</th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody id="ProductTbodyItem">
                                                                                <tr id="0">
                                                                                    <td colspan="4" style="text-align:center;">No Records...</td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                                <div class="tab-pane fade" id="profile">
                                                                    <div class="pt-4">
                                                                        <div class="table-responsive">
                                                                            <table class="table table-responsive-sm table-striped  text-black" id="ProductDetails">
                                                                                <thead class="bg-primary text-white">
                                                                                    <tr>
                                                                                        @*<th></th>*@
                                                                                        <th>Images</th>
                                                                                        <th></th>
                                                                                        <th></th>
                                                                                        <th></th>

                                                                                    </tr>
                                                                                </thead>
                                                                                <tbody id="ProductHistoryTbody">
                                                                                    <tr id="0">
                                                                                        <td colspan="4" style="text-align:center;">No Records...</td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>

                                                                            <div class="modal-footer">
                                                                               
                                                                            </div>
                                                                        </div>

                                                                    </div>
                                                                </div>
                                                                <div class="tab-pane fade" id="UploadImages">
                                                                    <div class="pt-4">
                                                                        <div class="table-responsive">
                                                                            <table class="table table-responsive-sm table-striped  text-black" id="ProductImageUpload">
                                                                                <thead class="bg-primary text-white">
                                                                                    <tr>
                                                                                        @*<th></th>*@
                                                                                        <th>Images</th>
                                                                                        <th></th>
                                                                                        <th></th>
                                                                                        <th></th>

                                                                                    </tr>
                                                                                </thead>
                                                                                <tbody id="ProductImageUploadbody">
                                                                                    <tr id="0">
                                                                                        <td colspan="4" style="text-align:center;">No Records...</td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>

                                                                            <div class="modal-footer">

                                                                                <button type="button" id="btnSaveProductDetails" onclick="BindImageFils(this)" class="btn btn-primary">Save</button>

                                                                            </div>
                                                                        </div>

                                                                    </div>
                                                                </div>
                                                                <div class="tab-pane fade" id="UploadDocuments">
                                                                    <div class="pt-4">
                                                                        <div class="table-responsive">
                                                                            <table class="table table-responsive-sm table-striped  text-black" id="ProductWarentyUpload">
                                                                                <thead class="bg-primary text-white">
                                                                                    <tr>
                                                                                        @*<th></th>*@
                                                                                        <th>Images</th>
                                                                                        <th></th>
                                                                                        <th></th>
                                                                                        <th></th>

                                                                                    </tr>
                                                                                </thead>
                                                                                <tbody id="ProductDocuploadbody">
                                                                                    <tr id="0">
                                                                                        <td colspan="4" style="text-align:center;">No Records...</td>
                                                                                    </tr>
                                                                                </tbody>
                                                                            </table>

                                                                            <div class="modal-footer">

                                                                                <button type="button" id="btnSaveProductDetails" onclick="BindDocFils(this)" class="btn btn-primary">Save</button>

                                                                            </div>
                                                                        </div>

                                                                    </div>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                    <!-- /# card -->
                                                </div>

                                            </div>

                                            <input type="hidden" name="FK_Customerserviceregister" />

                                        </div>
                                        @*<div class="modal-footer">
                            <button type="button" id="btnUpdate" onclick="fn_SaveCustomerServiceAssign(this);" class="btn btn-primary">Update</button>
                            <button type="button" id="btnSave" onclick="fn_SaveCustomerServiceAssign(this);" class="btn btn-primary">Save</button>
                            <button type="button" class="btn btn-danger light" data-dismiss="modal">Cancel</button>
                        </div>*@

                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-4 col-form-label">
                                            <span perfect-class="formGroupLabel">Customer Note</span>

                                        </label>
                                        <div class="col-lg-8  PerError">
                                            <span class="text-danger temptableError"></span>
                                            <textarea type="text" class="form-control" name="CustomerNote" rows="3" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input"></textarea>
                                            @*<textarea type="text" class="form-control text-right" placeholder="" name="CustomerNote" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />*@
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-4 col-form-label">
                                            <span perfect-class="formGroupLabel">Employee Note</span>

                                        </label>
                                        <div class="col-lg-8">
                                            <textarea type="text" class="form-control" name="EmployeeNote" rows="3" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input"></textarea>

                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-4 col-form-label">
                                            <span perfect-class="formGroupLabel">Service Amount</span>

                                        </label>
                                        <div class="col-lg-8">
                                            <div class="input-group mb-2">
                                                <div class="input-group-prepend">
                                                    <span class="input-group-text fa fa-money bg-primary text-white"></span>
                                                </div>
                                                <input type="text" class="form-control text-right" readonly="readonly" placeholder="" name="ServiceAmount" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-4 col-form-label">
                                            <span perfect-class="formGroupLabel">Replace Amount</span>

                                        </label>
                                        <div class="col-lg-8">
                                            <input type="text" class="form-control text-right" readonly="readonly" placeholder="" name="ReplaceAmount" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-4 col-form-label">
                                            <span perfect-class="formGroupLabel">Product Amount</span>

                                        </label>
                                        <div class="col-lg-8">
                                            <input type="text" class="form-control text-right" readonly="readonly" placeholder="" name="ProductAmount" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-4 col-form-label">
                                            <span perfect-class="formGroupLabel">Total Amount</span>

                                        </label>
                                        <div class="col-lg-8">
                                            <input type="text" class="form-control text-right" readonly="readonly" placeholder="" name="TotalAmount" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-4 col-form-label">
                                            <span perfect-class="formGroupLabel">Discount Amount</span>

                                        </label>
                                        <div class="col-lg-8">
                                            <input type="text" class="form-control text-right" placeholder="" name="DiscountAmount" onchange="CalculateTotal(this)" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-4 col-form-label">
                                            <span perfect-class="formGroupLabel">Net Amount</span>

                                        </label>
                                        <div class="col-lg-8">
                                            <input type="text" class="form-control  text-right" readonly="readonly" placeholder="" name="NetAmount" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-4 col-form-label">
                                            <span perfect-class="formGroupLabel">Action</span>

                                        </label>
                                        <div class="col-lg-8">
                                            <select class="form-control perfectValidate_string" name="NextAction" onchange="fn_bindate(this)" perfect-class="formGroupControl" perfect-ctype="select" perfect-css="select">
                                                <option value="0">Please select</option>
                                                @if (!(Model.NextActionMode is null))
                                                {
                                                    foreach (var Mode in Model.NextActionMode)
                                                    {
                                                        <option value="@Mode.ID_NextAction+_+@Mode.FK_ActionStatus">@Mode.NxtActnName</option>
                                                    }
                                                }
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xl-6">
                                    <div class="form-group row" perfect-class="formGroup">
                                        <label class="col-lg-4 col-form-label">
                                            <span perfect-class="formGroupLabel " style="display:none" class="lblAction">Action Date</span>

                                        </label>
                                        <div class="col-lg-8">
                                            <input type="date" class="form-control ActionDate" style="display:none" name="ActionDate" perfect-class="formGroupControl" perfect-ctype="date" perfect-css="date">

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-footer text-right" perfect-class="formFooter">
                                <button type="button" id="btnSave" onclick="fn_SaveCustomerService(this);" class="btn btn-primary">Save</button>
                            </div>
                        </form>

                        @*</form>*@


                        @*</form>*@
                    </div>
                    </div>
        </div>
    </div>
</div>
</div>
@section scripts{

    <script>
         const $formContainer = $('#jq_ServiceIndex_formContainer');
                $(document).ready(function () {
        //  $formContainer.find('.jq_Service_body').toggleClass('.d-none');
         let $thisForm = $(this).find('[perfect-class="form"]');
                    $thisForm.closest('.jq_Service_body').find('.ServiceformSesction').addClass('d-none');
                    let $thisFormPrhistory = $(this).find('[perfect-class="ProHistory"]');
                    $thisFormPrhistory.closest('.jq_ProHistory_body').find('.ProductHisformSesction').addClass('d-none');
                  
                  //  $('#GridData').DataTable();
    $('#GridData').DataTable({
            "searching": false,
        "paging": false,
            "info": false,
         "bAutoWidth": false,
        "bLengthChange": false,
        "recordsFiltered":false,
        "ordering": false
        });
                    // SearchUsingKeyWord();
                });

                function Filter(ele) {

                    $('.bd-example-modal-sm').modal('show');
        }
        $(function () {
            var d = new Date(),
                h = d.getHours(),
                m = d.getMinutes();
            if (h < 10) h = '0' + h;
            if (m < 10) m = '0' + m;
            $('input[type="time"][value="now"]').each(function () {
                $(this).attr({ 'value': h + ':' + m });
            });
           // $("#Servicefromdate").datepicker({ maxDate: new Date() });

           // var dtToday = new Date();

            var month = d.getMonth() + 1;
            var day = d.getDate();
            var year = d.getFullYear();

            if (month < 10)
                month = '0' + month.toString();
            if (day < 10)
                day = '0' + day.toString();

            var maxDate = year + '-' + month + '-' + day;
         //   var today = moment().format('YYYY-MM-DD');
           // $('input[name=Servicefromdate]').val(today);

            $('#Servicefromdate').attr('max', maxDate);
        });
        $(document).ready(function () {
            let now = new Date();
            var date = new Date();

            var day = date.getDate();
            var month = date.getMonth() + 1;
            var year = date.getFullYear();

            if (month < 10) month = "0" + month;
            if (day < 10) day = "0" + day;

            var today = year + "-" + month + "-" + day;
            $("#Servicefromdate").attr("value", today);
        });
        function fn_bindate(ele) {
            console.log($(ele).val());
            var FK_ActionStatus = $(ele).val().split("_+")[1];
            var ID_NextAction = $(ele).val().split("+_")[0];
           // console.log("j", FK_ActionStatus, ID_NextAction)
            if (FK_ActionStatus == 5 || FK_ActionStatus == 7) {
               
                $(".ActionDate").css('display', 'none');
                $(".lblAction").css('display', 'none');
            }
            else {
                $(".ActionDate").css('display', 'block');
                $(".lblAction").css('display', 'block');
            }
           // let ID_NextAction = $(ele).val();
           
          //  let $thisForm = $(ele).closest('[perfect-class="form"]');
          //  $(".ActionDate").css('display', 'block');
        }

        function GetProductDetails(ele, id) {
            let $sidemenu = $sideMenuOptions.body;
            console.log("gfhfgh",$sidemenu);
            $sideMenuOptions.title.find('h4').text('Place ');

     //   ClearModalInput();

        var $thisForm = $(ele).closest('[perfect-class="form-Assign"]');
        var InputData = {
            'ID_Product': id
        }

        $.ajax({
            url: "@Url.Action("GetProductHistoryDetails", "ServiceList")",
            type: "Get",
            data: InputData,
            dataType: "json",
            contentType: "application/json",
            success: function (ajaxOutput) {
               // $('[name=FK_Customerserviceregister]').val($(ele).attr('data-id'));
                $TicketHtml = '';
                if (ajaxOutput != null) {


                    if (ajaxOutput != null) {

                        $('#ProductTbody').empty();
                       // var ProductData = ajaxOutput.Data;

                        $ProductHtml = '';

                        if (ajaxOutput.Data.length > 0) {
                            $.each(ajaxOutput.Data, function (i, value) {
                              
                                let rowCount = (i + 1);

                                $ProductHtml += "<tr id=" + rowCount + ">";
                                $ProductHtml += "<td style='text-align: center;'>" + rowCount + "</td>";
                                $ProductHtml += "<td>" + value.Product + "</td>";
                                $ProductHtml += "<td>" + value.ProductComplaint + "</td>";
                                $ProductHtml += "<td>" + value.ProductDescription + "</td>";
                                $ProductHtml += "<td>" + value.Warrenty + "</td>";
                                $ProductHtml += "<td>" + value.WarrentyDate + "</td>";
                                $ProductHtml += "<td>" + value.ModelNo + "</td>";
                                $ProductHtml += "</tr>";
                            });
                        }
                        else {
                            $ProductHtml += "<tr id='0'><td colspan='4' style'text-align:center'>No Records..</td></tr>";
                        }

                        $('#ProductTbody').append($ProductHtml);
                    }



                  //  $('#btnUpdate').css('display', 'none');
                  //  $('#btnSave').css('display', 'block');
                    $('.bd-service-modal-sm').modal('show');
                }
                else {
                    $.each(ajaxOutput.Process.Message, function (key, value) {
                        NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': value });
                    });
                }
            },
            complete: function () {
                $(ele).prop('disabled', false);
            }
        });

        }


         function GetProductData(ele, id) {
           

     //   ClearModalInput();

        var $thisForm = $(ele).closest('[perfect-class="form-Assign"]');
        var InputData = {
            'ID_Product': id
        }

        $.ajax({
            url: "@Url.Action("GetProductHistoryDetails", "ServiceList")",
            type: "Get",
            data: InputData,
            dataType: "json",
            contentType: "application/json",
            success: function (ajaxOutput) {
               // $('[name=FK_Customerserviceregister]').val($(ele).attr('data-id'));
                $TicketHtml = '';
                if (ajaxOutput != null) {


                    if (ajaxOutput != null) {

                        $('#ProductHistoryTbody').empty();
                       // var ProductData = ajaxOutput.Data;

                        $ProductHtml = '';

                        if (ajaxOutput.Data.length > 0) {
                            $.each(ajaxOutput.Data, function (i, value) {
                              
                                let rowCount = (i + 1);

                                $ProductHtml += "<tr id=" + rowCount + ">";
                             //   $ProductHtml += "<td style='text-align: center;'>" + rowCount + "</td>";
                               // $ProductHtml += "<td>" + value.ProductImage + "</td>";

                               // $Assigned = "<a class='btn btn-rounded btn-success mr-3 ml-auto'  href='" + url + "' target='_blank' data-id=" + value.Ticket + ">Show</a>";
                              //  $ProductHtml += "<td <a href="@Url.Action("DownloadImage", "ServiceList")">Features</a>>" + value.ID_Product + "</td>";
                               let url = '@Url.Action("DownloadImage", "ServiceList")' + '?ID=' + value.ID_Product
                               // $ProductHtml = "<td>" + value.ProductImage + "</td>";
                                $Assigned = "<a class='btn btn-rounded btn-success mr-3 ml-auto'  href='" + url + "' data-id=" + value.ID_Product + ">Download</a>";
                                $ProductHtml += "<td class='jq_ProductServicesAmnt_td' ><img src=" + value.ProductImage + " width = '50%' /></td>";
                                $ProductHtml += "<td><div class='' style=''>" + $Assigned + "<div class='dropdown float-left custom-dropdown mb-0'></div></div><td>";
                              //  $ProductHtml += "<td class='jq_ProductServicesAmnt_td' ><input type='file'  id='fupload'  name='input - file - preview' class='form-control'  /></td>";
                               // $ProductHtml = "<td>" + '@Url.Action("DownloadImage", "ServiceList")' + '?ID=' + value.ID_Product + "</td>";
                                $ProductHtml += "</tr>";
                            });
                        }
                        else {
                            $ProductHtml += "<tr id='0'><td colspan='4' style'text-align:center'>No Records..</td></tr>";
                        }

                        $('#ProductHistoryTbody').append($ProductHtml);
                        $('.bd-ProductHistory-modal-sm').modal('show');
                    }
                    if (ajaxOutput != null) {

                        $('#ProductTbodyItem').empty();
                        // var ProductData = ajaxOutput.Data;

                        $ProductHtml = '';

                        if (ajaxOutput.Data.length > 0) {
                            $.each(ajaxOutput.Data, function (i, value) {

                                let rowCount = (i + 1);

                                $ProductHtml += "<tr id=" + rowCount + ">";
                                $ProductHtml += "<td style='text-align: center;'>" + rowCount + "</td>";
                                $ProductHtml += "<td>" + value.Product + "</td>";
                                $ProductHtml += "<td>" + value.ProductComplaint + "</td>";
                                $ProductHtml += "<td>" + value.ProductDescription + "</td>";
                                $ProductHtml += "<td>" + value.Warrenty + "</td>";
                                $ProductHtml += "<td>" + value.WarrentyDate + "</td>";
                                $ProductHtml += "<td>" + value.ModelNo + "</td>";
                                $ProductHtml += "</tr>";
                            });
                        }
                        else {
                            $ProductHtml += "<tr id='0'><td colspan='4' style'text-align:center'>No Records..</td></tr>";
                        }

                        $('#ProductTbodyItem').append($ProductHtml);
                    }
                    if (ajaxOutput != null) {

                        $('#ProductImageUploadbody').empty();
                       // var ProductData = ajaxOutput.Data;

                        $ProductHtml = '';

                        if (ajaxOutput.Data.length > 0) {
                            $.each(ajaxOutput.Data, function (i, value) {
                              
                                let rowCount = (i + 1);

                                $ProductHtml += "<tr id=" + rowCount + ">";
                                $ProductHtml += "<td class='jq_Image_ID_Product' Style='Display:none'>" + value.ID_Product + "</td>";
                                $ProductHtml += "<td class='jq_UploadImage_td' ><input type='file'  id='fupload'  name='input - file - preview' class='form-control'  /></td>";
                                $ProductHtml += "<td class='jq_ProductImageID_td' ><img id='imgFiletemp' src='' width = '50%' /></td>";
                                $ProductHtml += "<td class='jq_UploadImagename_td' ><input type='text'  id='imageUpladname'  style='Display:none'  name='imageUpladname' class='form-control'  /></td>";
                                //<img id="imgFiletemp" src="" style="display:none" perfect-tempTable-Purchase="imgFile" name="imgFiletemp" />
                                $ProductHtml += "</tr>";
                            });
                        }
                        else {
                            $ProductHtml += "<tr id='0'><td colspan='4' style'text-align:center'>No Records..</td></tr>";
                        }

                        $('#ProductImageUploadbody').append($ProductHtml);
                        $('.bd-ProductHistory-modal-sm').modal('show');
                    }
                    if (ajaxOutput != null) {

                        $('#ProductDocuploadbody').empty();
                        // var ProductData = ajaxOutput.Data;

                        $ProductHtml = '';

                        if (ajaxOutput.Data.length > 0) {
                            $.each(ajaxOutput.Data, function (i, value) {

                                let rowCount = (i + 1);

                                $ProductHtml += "<tr id=" + rowCount + ">";
                                let url = '@Url.Action("DownloadDoc", "ServiceList")' + '?ID=' + value.ID_Product
                                $Assigned = "<a class='btn btn-rounded btn-success mr-3 ml-auto'  href='" + url + "' data-id=" + value.ID_Product + "></a>";
                                $ProductHtml += "<td class='jq_Doc_ID_Product' Style='Display:none'>" + value.ID_Product + "</td>";
                                $ProductHtml += "<td class='jq_UploadDoc_td' ><input type='file'  id='fuploadDoc'  name='input - file - preview' class='form-control'  /></td>";
                               // $ProductHtml += "<td><div class='' style=''>" + $Assigned + "<div class='dropdown float-left custom-dropdown mb-0'></div></div><td>";
                                $ProductHtml += "<td Style='Display:none' class='jq_Docimage_td'><a href='" + url + "'><img id='imgDocFiletemp' class='btn btn-rounded btn-success mr-3 ml-auto' src='' width = '50%' /></a>DownLoad</td>";
  
                                $ProductHtml += "<td class='jq_DocImagename_td' ><input type='text'  id='DocUpladname'  style='Display:none'  name='imageUpladname' class='form-control'  /></td>";
                                //<img id="imgFiletemp" src="" style="display:none" perfect-tempTable-Purchase="imgFile" name="imgFiletemp" />
                                $ProductHtml += "</tr>";
                            });
                        }
                        else {
                            $ProductHtml += "<tr id='0'><td colspan='4' style'text-align:center'>No Records..</td></tr>";
                        }

                        $('#ProductDocuploadbody').append($ProductHtml);
                        //$('.bd-ProductHistory-modal-sm').modal('show');
                    }
                  
                
                   
                }
                else {
                    $.each(ajaxOutput.Process.Message, function (key, value) {
                        NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': value });
                    });
                }
            },
            complete: function () {
                $(ele).prop('disabled', false);
            }
        });

        }

        $(document).on("change", '#fupload', function () {
            readURL(this);
        })

        $(document).on("change", '#fuploadDoc', function () {
            readDoc(this);
        })

        function readDoc(input) {

            console.log("FGFG", input);
            if (input.files && input.files[0]) {
                alert("g");
                var reader = new FileReader();

                reader.onload = function (e) {
                    //$(input).parent('.input-file-image').find('.img-upload-preview').attr('src', e.target.result);
                    $('#imgDocFiletemp').attr('src', e.target.result)

                    $('#DocUpladname').val(input.files[0]["name"]);
                    //console.log("fgfg2", input.files[0]["name"])
                    // alert('Filer' + e.target.result)

                }
                reader.onloadend = function (e) {
                    //controller call
                    //alert('Filer2' + e.target.result)

                }
                reader.readAsDataURL(input.files[0]);

            }
        }

        //function bindfile(fileValue) {
        //    readURL(fileValue);
        //}
        //$('#fupload').change(function () {
        //    readURL(this);
        //});
        function readURL(input) {

            console.log("FGFG",input);
            if (input.files && input.files[0]) {
                alert("g");
                    var reader = new FileReader();

                    reader.onload = function (e) {
                        //$(input).parent('.input-file-image').find('.img-upload-preview').attr('src', e.target.result);
                        $('#imgFiletemp').attr('src', e.target.result)
                        
                        $('#imageUpladname').val(input.files[0]["name"]);
                        //console.log("fgfg2", input.files[0]["name"])
                       // alert('Filer' + e.target.result)
                       
                    }
                    reader.onloadend = function (e) {
                        //controller call
                        //alert('Filer2' + e.target.result)
                        
                    }
                    reader.readAsDataURL(input.files[0]);
                   
                }
            }

            function GetCustomerDetails(ele, id) {

     //   ClearModalInput();
        alert(id);
        var $thisForm = $(ele).closest('[perfect-class="form-CUstomer"]');
        var InputData = {
            'FK_Customer': id
        }

        $.ajax({
            url: "@Url.Action("GetCustomerHistoryDetails", "ServiceList")",
            type: "Get",
            data: InputData,
            dataType: "json",
            contentType: "application/json",
            success: function (ajaxOutput) {
               // $('[name=FK_Customerserviceregister]').val($(ele).attr('data-id'));
                $TicketHtml = '';
                if (ajaxOutput != null) {


                    if (ajaxOutput != null) {

                        $('#CustomerTbody').empty();
                       // var ProductData = ajaxOutput.Data;

                        $ProductHtml = '';

                        if (ajaxOutput.Data.length > 0) {
                            $.each(ajaxOutput.Data, function (i, value) {
                               
                                let rowCount = (i + 1);

                                $ProductHtml += "<tr id=" + rowCount + ">";
                                $ProductHtml += "<td style='text-align: center;'>" + rowCount + "</td>";
                                $ProductHtml += "<td>" + value.TicketNo + "</td>";
                                $ProductHtml += "<td>" + value.TicketDate + "</td>";
                                $ProductHtml += "<td>" + value.FollowUpDate + "</td>";
                                $ProductHtml += "<td>" + value.Product + "</td>";
                                $ProductHtml += "<td>" + value.ProductComplaint + "</td>";
                                $ProductHtml += "<td>" + value.ProductDescription + "</td>";
                                $ProductHtml += "<td>" + value.ProductStatus + "</td>";
                               
                                $ProductHtml += "</tr>";
                            });
                        }
                        else {
                            $ProductHtml += "<tr id='0'><td colspan='4' style'text-align:center'>No Records..</td></tr>";
                        }

                        $('#CustomerTbody').append($ProductHtml);
                    }



                  //  $('#btnUpdate').css('display', 'none');
                  //  $('#btnSave').css('display', 'block');
                    $('.bd-service-modal-smcustomer').modal('show');
                }
                else {
                    $.each(ajaxOutput.Process.Message, function (key, value) {
                        NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': value });
                    });
                }
            },
            complete: function () {
                $(ele).prop('disabled', false);
            }
        });

    }
        function GetServices(ele, id) {

    
       
        var $thisForm = $(ele).closest('[perfect-class="form-Assign"]');
        var InputData = {
            'ID_Product': id
        }

        $.ajax({
            url: "@Url.Action("GetServiceDetails", "ServiceList")",
            type: "Get",
            data: InputData,
            dataType: "json",
            contentType: "application/json",
            success: function (ajaxOutput) {
               // $('[name=FK_Customerserviceregister]').val($(ele).attr('data-id'));
                $TicketHtml = '';
                if (ajaxOutput != null) {


                    if (ajaxOutput != null) {

                        $('#ProductServiceTbody').empty();
                       // var ProductData = ajaxOutput.Data;

                        $ProductHtml = '';

                        if (ajaxOutput.Data.length > 0) {
                            $.each(ajaxOutput.Data, function (i, value) {
                               console.log("sas",ajaxOutput.Data);
                                let rowCount = (i + 1);

                                $ProductHtml += "<tr id=" + rowCount + ">";
                                $ProductHtml += "<td class='jq_ProductServices_ID_Services' Style='Display:none'>" + value.ID_Services + "</td>";
                                $ProductHtml += "<td class='jq_ProductServices_ID_Product' Style='Display:none'>" + value.ID_Product + "</td>";
                            //    $ProductHtml += "<td style='text-align: center;'>" + rowCount + "</td>";
                                $ProductHtml += "<td class='jq_ProductServices_td' ><input type='checkbox'  value='" + value.ProductStatus + "' /></td>";
                                 $ProductHtml += "<td>" + value.ServiceList + "</td>";
                                $ProductHtml += "<td class='jq_ProductServicesAmnt_td' ><input type='textbox'  class='form-control' value='" + value.Amount + "' /></td>";
                                $ProductHtml += "<td class='jq_ProductServicesRemarks_td' ><input type='textbox' class='form-control'  value='" + value.Remarks + "' /></td>";
                                
                               
                              
                                $ProductHtml += "</tr>";
                            });
                        }
                        else {
                            $ProductHtml += "<tr id='0'><td colspan='4' style'text-align:center'>No Records..</td></tr>";
                        }

                        $('#ProductServiceTbody').append($ProductHtml);
                    }



                  //  $('#btnUpdate').css('display', 'none');
                  //  $('#btnSave').css('display', 'block');
                    $('.bd-Productservice-modal-sm').modal('show');
                }
                else {
                    $.each(ajaxOutput.Process.Message, function (key, value) {
                        NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': value });
                    });
                }
            },
            complete: function () {
                $(ele).prop('disabled', false);
            }
        });

        }
        function GetProserDetails(ele, id) {

    
       
        var $thisForm = $(ele).closest('[perfect-class="form-Assign"]');
        var InputData = {
            'ID_Product': id
        }

        $.ajax({
            url: "@Url.Action("GetProductDetails", "ServiceList")",
            type: "Get",
            data: InputData,
            dataType: "json",
            contentType: "application/json",
            success: function (ajaxOutput) {
               // $('[name=FK_Customerserviceregister]').val($(ele).attr('data-id'));
                $TicketHtml = '';
                if (ajaxOutput != null) {


                    if (ajaxOutput != null) {

                        $('#ProductDetailsTbody').empty();
                        console.log("FGFG", ajaxOutput.Lits.Data);
                        console.log("FGFGVew", ajaxOutput.ChangeMod.Data);
                      
                        let options = ''
                        $.each(ajaxOutput.ChangeMod.Data, function (i, value) {
                           options += '<option value=' + value.ID_Mode + '>' + value.ModeName + '</option>'
                        });
                        let $dropdown = '<select class="form-control" onchange="bindTextbox(this)">' + options + '</select>';
                        alert($dropdown);
                        $ProductHtml = '';

                        if (ajaxOutput.Lits.Data.length > 0) {
                            $.each(ajaxOutput.Lits.Data, function (i, value) {
                               
                                let rowCount = (i + 1);
                               // let options = ''
                              //  options += '<option value=' + 1 + '>' + "Replace" + '</option>'
                              //  options += '<option value=' + 2 + '>' + "StandBy" + '</option>'
                              //  let $dropdown = '<select class="form-control"  >' + options + '</select>';
                               
                                $ProductHtml += "<tr id=" + rowCount + ">";
                            //    $ProductHtml += "<td style='text-align: center;'>" + rowCount + "</td>";
                                $ProductHtml += "<td class='jq_ProductDet_td' ><input type='checkbox'  value='" + value.ID_Product + "' /></td>";
                                $ProductHtml += "<td >" + value.ProdName + "</td>";
                                $ProductHtml += "<td class='jq_ProductDetQty_td' ><input type='textbox' class='form-control' value='" + value.Quantity + "' /></td>";
                                $ProductHtml += "<td class='jq_ProductDetAmnt_td' ><input type='textbox'  class='form-control' value='" + value.Amount + "' /></td>";
                                $ProductHtml += "<td class='jq_ProductChangeMode_td'  >" + $dropdown + "</td>";
                                 $ProductHtml += "<td class='jq_ProductDetReplaAmnt_td' ><input type='textbox' class='form-control' value='" + value.ReplaceAmount + "' /></td>";
                               $ProductHtml += "<td class='jq_ProductDetModelNO_td' ><input type='textbox' class='form-control' value='" + value.ModelNo + "' /></td>";
        //"<td >" + value.ModelNo + "</td>";
                              
                                $ProductHtml += "<td class='jq_ProductDetRemarks_td' ><input type='textbox' class='form-control'  value='" + value.Remarks + "' /></td>";
                                
                               
                              
                                $ProductHtml += "</tr>";
                            });
                        }
                        else {
                            $ProductHtml += "<tr id='0'><td colspan='4' style'text-align:center'>No Records..</td></tr>";
                        }

                        $('#ProductDetailsTbody').append($ProductHtml);
                    }



                  //  $('#btnUpdate').css('display', 'none');
                  //  $('#btnSave').css('display', 'block');
                    $('.bd-ProductDetails-modal-sm').modal('show');
                }
                else {
                    $.each(ajaxOutput.Process.Message, function (key, value) {
                        NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': value });
                    });
                }
            },
            complete: function () {
                $(ele).prop('disabled', false);
            }
        });

        }
        @*function GetProserDetails(ele, id) {

    
       
        var $thisForm = $(ele).closest('[perfect-class="form-Assign"]');
        var InputData = {
            'ID_Product': id
        }

        $.ajax({
            url: "@Url.Action("GetProductDetails", "ServiceList")",
            type: "Get",
            data: InputData,
            dataType: "json",
            contentType: "application/json",
            success: function (ajaxOutput) {
              
                $TicketHtml = '';
                if (ajaxOutput != null) {


                    if (ajaxOutput != null) {

                        $('#ProductDetailsTbody').empty();
                      

                        $ProductHtml = '';

                        if (ajaxOutput.Data.length > 0) {
                            $.each(ajaxOutput.Data, function (i, value) {
                                let options = ''
                                options += '<option value=' + 1 + '>' + "Replace" + '</option>'
                                options += '<option value=' + 2 + '>' + "StandBy" + '</option>'
                                let $dropdown = '<select class="form-control" >' + options + '</select>';
                                console.log("jh", $dropdown)
                                let rowCount = (i + 1);

                                $ProductHtml += "<tr id=" + rowCount + ">";
                          
                             
                               $ProductHtml += "<td class='jq_ProductDet_td' ><input type='checkbox'  value='" + value.ID_Product + "' /></td>";
                                $ProductHtml += "<td>" + value.ProdName + "</td>";
                                $ProductHtml += "<td class='jq_ProductDetQty_td' ><input type='textbox'  value='" + value.Quantity + "' /></td>";
                                $ProductHtml += "<td class='jq_ProductDetAmnt_td' ><input type='textbox'  value='" + value.Amount + "' /></td>";
                                $ProductHtml += "<td class='jq_ProductChangeMode_td'>" + $dropdown + "</td>";
                                 $ProductHtml += "<td class='jq_ProductDetRemarks_td' ><input type='textbox'  value='" + value.Remarks + "' /></td>";
                                $ProductHtml += "</tr>";
                            });
                        }
                        else {
                            $ProductHtml += "<tr id='0'><td colspan='4' style'text-align:center'>No Records..</td></tr>";
                        }

                        $('#ProductDetailsTbody').append($ProductHtml);
                    }



                    $('.bd-ProductDetails-modal-sm').modal('show');
                }
                else {
                    $.each(ajaxOutput.Process.Message, function (key, value) {
                        NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': value });
                    });
                }
            },
            complete: function () {
                $(ele).prop('disabled', false);
            }
        });

    }*@

          function fn_showFilter() {

        $formContainer.find('.jq_Service_body').find('.ServiceformSesction').toggleClass('d-none');

        let $thisForm = $(this).find('[perfect-class="form"]');

             //   $thisForm.find('[name="Servicefromdate"]').val(moment().format('YYYY-MM-DD'));

      //  $('#ServiceFdate').datepicker({
      //  format: "dd/mm/yyyy",
      //  autoclose: true,
      //  orientation: "top",
      //  endDate: "today"

 // });
    }
        function bindTextbox(ele) {
            let Value = $(ele).val();
            
            if (Value == 1) {

                $(ele).closest('tr').find('.jq_ProductDetReplaAmnt_td').find('input').prop('readonly', false)
                
            }
            else {
                $(ele).closest('tr').find('.jq_ProductDetReplaAmnt_td').find('input').prop('readonly', true)
                $(ele).closest('tr').find('.jq_ProductDetReplaAmnt_td').find('input').val("0");
            }
        }

        function fn_showProHistory() {

            $formContainer.find('.jq_ProHistory_body').find('.ProductHisformSesction').toggleClass('d-none');

            let $thisForm = $(this).find('[perfect-class="form"]');
        }

        @*function showimportModal(ele) {
            alert(ele);

            let $thisForm = $(ele).closest('[perfect-class="form"]');
            console.log('fgf', $thisForm)
            // $thisForm.find('[name=Name]').val($thisForm.find('[name="ProName"]').val())
            //ProName
            $thisForm.find('[perfect-class="formGroupModal"]').modal('show');
           // $(ele).closest('[perfect-class="formGroup"]').find('[perfect-class="formGroupModal"]').modal('show');

            // searchimpbtn2(ele);
            //trigger search
            // $(ele).closest('[perfect-class="formGroup"]').find('[perfect-class="formGroupModal"]')
        }
        function showItemModal(ele) {

            let $thisForm = $(ele).closest('[perfect-class="form"]');

          //  $thisForm.find('[name=Name]').val($thisForm.find('[name="ProName"]').val())
            //ProName
            $(ele).closest('[perfect-class="formGroup"]').find('[perfect-class="formGroupProductModal"]').modal('show');

            searchbtn2(ele);
            //trigger search
            // $(ele).closest('[perfect-class="formGroup"]').find('[perfect-class="formGroupModal"]')
        }
          function searchbtn2(ele) {

        let $thisForm = $(ele).closest('[perfect-class="form"]');
       

              let $model = $(ele).closest('[perfect-class="formGroup"]').find('[perfect-class="formGroupProductModal"]');
              $(ele).closest('[perfect-class="formGroup"]').find('[perfect-class="formGroupProductModal"]').modal('show');
          $.ajax({
            url: '@Url.Action("GetProductDetails", "Sales")',
            type: "POST",

             // data: JSON.stringify(searchValue),
              data:  "",
            dataType: "json",
              contentType: "application/x-www-form-urlencoded; charset=utf-8",
            success: function (successData) {
                console.log('> Search button click success', successData);

                if (successData.Process.IsProcess) {
                    var sss = createSelectListWithSearch({
                        data: successData.Data, element: $model, onlyShowColumn: ["ProdName", "ProdShortName", "MRP", "SalPrice", "CurrentStock"],
                        renameHeader: { ProdName: "Name", ProdShortName: "ShortName", SalPrice: "Sales Price" }
                    });
                    sss.then(function (ret) {
                        if (ret) {
                            console.log('>_ Search button > list click', ret);
                            $thisForm.find('[name=ProductID]').val(ret.ProductID);
                            $thisForm.find('[name=ProName]').focus().val(ret.ProdName);
                            $thisForm.find('[name=SalPrice]').focus().val(ret.SalPrice);
                            $thisForm.find('[name=Sprice]').focus().val(ret.SalPrice);
                            $thisForm.find('[name=MRP]').focus().val(ret.MRP);
                          //  $thisForm.find('[name=ProName]').focus().val(ret.MRP);
                          //  $thisForm.find('[name=ProName]').focus().val(ret.SalPrice);
                           // $thisForm.find('[name=UnitID]').focus().val((ret.UnitID.length == 0) ? '' : ret.UnitID).selectpicker('refresh');
                           // $thisForm.find('[name=NoOfUnits]').focus().val(ret.NoOfUnits);

                        }
                        else {
                            console.log(ret);
                        }
                    });

                      }
                      else {
                          $.each(successData.Process.Message, function (key, value) {
                              //toastr.warning(value, "Error");
                              NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': value });
                          });
                      }




                  },
                  complete: function () {

                      //a.find('.dataTables_wrapper').css('width', '100%');
                  }
              });

             
        }*@
        function BindServiceAmount(ele) {
        console.log('inside binddatat fn')
        let $modal = $(ele).closest('.modal');
        let $thisForm = $(ele).closest('[perfect-class="Assign"]');
        let sum = 0;
        $modal.find('table tbody').find('tr').each(function () {
            let value = parseFloat($(this).find('.jq_ProductServicesAmnt_td').find('input').val())
         console.log('checkbox',$(this).find('.jq_ProductServices_td').find('[type="checkbox"]').is(':checked'))
            if ($(this).find('.jq_ProductServices_td').find('[type="checkbox"]').is(':checked') == true) {
                 console.log('intrue')
                value=value * 1;
            }
        else
        {
         console.log('infalse')
        value=value * 0;
        }
            sum = sum + value;

        });
        $thisForm.find('[name=ServiceAmount]').val(sum);
        CalculateTotal(ele);
         $('.bd-Productservice-modal-sm').modal('hide');
        
    }
        function BindProductAmount(ele) {
        console.log('inside binddatat fn')
        let $modal = $(ele).closest('.modal');
        let $thisForm = $(ele).closest('[perfect-class="Assign"]');
        let Replacesum = 0;
         let Productsum = 0;
        $modal.find('table tbody').find('tr').each(function () {
            let ReplaceAmount = parseFloat($(this).find('.jq_ProductDetReplaAmnt_td').find('input').val())
         let PrAmount = parseFloat($(this).find('.jq_ProductDetAmnt_td').find('input').val())
           
            Replacesum = Replacesum + ReplaceAmount;
        Productsum=Productsum+PrAmount
        });

        $thisForm.find('[name=ReplaceAmount]').val(Replacesum);
          $thisForm.find('[name="ProductAmount"]').val(Productsum);
        CalculateTotal(ele);
         $('.bd-ProductDetails-modal-sm').modal('hide');
        }


        function BindImageFils(ele) {
            alert('f');
            console.log('inside binddatat fn')
            let $modal = $(ele).closest('.modal');
            let $thisForm = $(ele).closest('[perfect-class="Assign"]');
            $modal.find('table tbody').find('tr').each(function () {
                var images = $('.jq_ProductImageID_td').attr('src');
                console.log('for relative image url ' + $('#imgFiletemp').attr('src'));
                console.log('fg', images);
            });

           
        }
        function BindDocFils(ele) {
            alert('f');
            console.log('inside binddatat fn')
            let $modal = $(ele).closest('.modal');
            let $thisForm = $(ele).closest('[perfect-class="Assign"]');
            $modal.find('table tbody').find('tr').each(function () {
                var images = $('.jq_UploadDoc_td').attr('src');
                console.log('for relative Doc url ' + $('#imgDocFiletemp').attr('src'));
               
            });


        }
         function CalculateTotal(ele) {
       
        let $thisForm = $(ele).closest('[perfect-class="Assign"]');
        let ReplaceAmount = $thisForm.find('[name="ReplaceAmount"]').val() == "" ? "0" : $thisForm.find('[name="ReplaceAmount"]').val();
        let Productsum = $thisForm.find('[name="ProductAmount"]').val() == "" ? "0" : $thisForm.find('[name="ProductAmount"]').val();
        let ServiceAmount = $thisForm.find('[name="ServiceAmount"]').val() == "" ? "0" : $thisForm.find('[name="ServiceAmount"]').val();
        let DiscAmnt = $thisForm.find('[name="DiscountAmount"]').val() == "" ? "0" : $thisForm.find('[name="DiscountAmount"]').val();
        let TotAmount=parseFloat(ServiceAmount)+parseFloat(Productsum)-parseFloat(ReplaceAmount);
        let NetAmount=parseFloat(TotAmount)-parseFloat(DiscAmnt);
       // console.log('as', Sprice + Salesprice);
        $thisForm.find('[name="TotalAmount"]').val(TotAmount);
        $thisForm.find('[name="NetAmount"]').val(NetAmount);
    }
         function GetCusDetails(ele) {

        ClearModalInput();

        var $thisForm = $(ele).closest('[perfect-class="form-Assign"]');
        var InputData = {
            'FK_Customerserviceregister': $(ele).attr('data-id')          
        }

        $.ajax({
            url: "@Url.Action("GetTicketDetails", "Service")",
            type: "Get",
            data: InputData,
            dataType: "json",
            contentType: "application/json",
            success: function (ajaxOutput) {                
                $('[name=FK_Customerserviceregister]').val($(ele).attr('data-id'));                                
                $TicketHtml = '';
                if (ajaxOutput != null) {
                    $('#TopDetails').empty();                                                       
                    $TicketHtml += "<div class='col-sm-6'>";
                    $TicketHtml += "<div class='profile-personal-info'>";
                    $TicketHtml += "<h4 class='text-primary mb-4'>Ticket Information</h4>";
                    $TicketHtml += "<div class='row mb-2'>";
                    $TicketHtml += "<div class='col-6'>";
                    $TicketHtml += "<h5 class='f-w-500'>Ticket <span class='pull-right'>:</span></h5>";
                    $TicketHtml += "</div>";
                    $TicketHtml += " <div class='col-6'><span>" + ajaxOutput['Ticket'] +"</span>";
                    $TicketHtml += "</div></div>";
                    $TicketHtml += "<div class='row mb-2'>";
                    $TicketHtml += "<div class='col-6'>";
                    $TicketHtml += "<h5 class='f-w-500'>Customer <span class='pull-right'>:</span></h5>";
                    $TicketHtml += "</div>";
                    $TicketHtml += " <div class='col-6'><span>" + ajaxOutput['Customer'] + "</span>";
                    $TicketHtml += "</div></div>";
                    $TicketHtml += "<div class='row mb-2'>";
                    $TicketHtml += "<div class='col-6'>";
                    $TicketHtml += "<h5 class='f-w-500'>Address <span class='pull-right'>:</span></h5>";
                    $TicketHtml += "</div>";
                    $TicketHtml += " <div class='col-6'><span>" + ajaxOutput['Address'] + "</span>";
                    $TicketHtml += "</div></div>";
                    $TicketHtml += "<div class='row mb-2'>";
                    $TicketHtml += "<div class='col-6'>";
                    $TicketHtml += "<h5 class='f-w-500'>Landmark <span class='pull-right'>:</span></h5>";
                    $TicketHtml += "</div>";
                    $TicketHtml += " <div class='col-6'><span>" + ajaxOutput['Landmark'] + "</span>";
                    $TicketHtml += "</div></div>";
                    $TicketHtml += "<div class='row mb-2'>";
                    $TicketHtml += "<div class='col-6'>";
                    $TicketHtml += "<h5 class='f-w-500'>Mobile <span class='pull-right'>:</span></h5>";
                    $TicketHtml += "</div>";
                    $TicketHtml += " <div class='col-6'><span>" + ajaxOutput['Mobile'] + "</span>";
                    $TicketHtml += "</div></div>";
                    $TicketHtml += "<div class='row mb-2'>";
                    $TicketHtml += "<div class='col-6'>";
                    $TicketHtml += "<h5 class='f-w-500'>Phone <span class='pull-right'>:</span></h5>";
                    $TicketHtml += "</div>";
                    $TicketHtml += " <div class='col-6'><span>" + ajaxOutput['OtherMobile'] + "</span>";
                    $TicketHtml += "</div></div>";
                    $TicketHtml += "</div>";
                    $TicketHtml += "</div>";

                    $TicketHtml += "<div class='col-sm-6'>";
                    $TicketHtml += "<div class='profile-personal-info'>";
                    $TicketHtml += "<h4 class='text-primary mb-4'>Service Information</h4>";
                    $TicketHtml += "<div class='row mb-2'>";
                    $TicketHtml += "<div class='col-6'>";
                    $TicketHtml += "<h5 class='f-w-500'>Visit Date <span class='pull-right'>:</span></h5>";
                    $TicketHtml += "</div>";
                    $TicketHtml += " <div class='col-6'><span>" + ConvertJsonDate(ajaxOutput['FromDate']) + "</span>";
                    $TicketHtml += "</div></div>";
                    $TicketHtml += "<div class='row mb-2'>";
                    $TicketHtml += "<div class='col-6'>";
                    $TicketHtml += "<h5 class='f-w-500'>Visit Time <span class='pull-right'>:</span></h5>";
                    $TicketHtml += "</div>";
                    $TicketHtml += " <div class='col-6'><span>" + ajaxOutput['FromTime'] + "</span>";
                    $TicketHtml += "</div></div>";
                    $TicketHtml += "</div>";
                    $TicketHtml += "</div>";
              
                    $('#TopDetails').append($TicketHtml);
                    
                    if (ajaxOutput.Product != null) {
                       
                        $('#ProductTbody').empty();                        
                        var ProductData = ajaxOutput.Product;
                        $ProductHtml = '';
                        if (ProductData.length > 0) {
                            $.each(ProductData, function (i, value) {
                                let rowCount = (i + 1);
                               
                                $ProductHtml += "<tr id=" + rowCount + ">";
                                $ProductHtml += "<td style='text-align: center;'>" + rowCount + "</td>";
                                $ProductHtml += "<td>" + value.Productname + "</td>";
                                $ProductHtml += "<td>" + value.ProductComplaint + "</td>";
                                $ProductHtml += "<td>" + value.ProductDescription + "</td>";
                                $ProductHtml += "</tr>";
                            });
                        }
                        else {
                            $ProductHtml += "<tr id='0'><td colspan='4' style'text-align:center'>No Records..</td></tr>";
                        }

                        $('#ProductTbody').append($ProductHtml);
                    }  

                    if (ajaxOutput.OtherProducts != null) {
                        $OtherProductHtml = '';
                        $('#OtherPorudctTbody').empty();
                        var OtherProductData = ajaxOutput.OtherProducts;
                        if (OtherProductData.length > 0) {
                            $.each(OtherProductData, function (i, value) {
                                let rowCount = (i + 1);
                                $OtherProductHtml += "<tr id=" + rowCount  + ">";
                                $OtherProductHtml += "<td style='text-align: center;'>" + rowCount + "</td>";
                                $OtherProductHtml += "<td>" + value.Company + "</td>";
                                $OtherProductHtml += "<td>" + value.Product + "</td>";
                                $OtherProductHtml += "<td>" + value.Complaint + "</td>";
                                $OtherProductHtml += "<td>" + value.Description + "</td>";
                                $OtherProductHtml += "</tr>";
                            });
                        }
                        else {
                            $OtherProductHtml += "<tr id='0'><td colspan='5' style'text-align:center'>No Records..</td></tr>";
                        }
                        $('#OtherPorudctTbody').append($OtherProductHtml)
                    }

                    $('#btnUpdate').css('display', 'none');
                    $('#btnSave').css('display', 'block');
                    $('.bd-service-modal-sm').modal('show');
                }
                else {
                    $.each(ajaxOutput.Process.Message, function (key, value) {
                        NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': value });
                    });
                }
            },
            complete: function () {
                $(ele).prop('disabled', false);
            }
        });

    }


        function fn_SaveCustomerService(ele) {

            let $thisForm = $(ele).closest('[perfect-class="Assign"]');
            
            let $thisFormNew = $(ele).closest('.jq_service_commonForm_div').find('[perfect-class="form"]');
            if ($thisForm.valid()) {
                alert('ghg');
                let $thisFormCus = $(ele).closest('[perfect-class="customer"]');
                console.log("Fu", $thisFormCus)
                console.log("FFjhjgjh", $thisFormNew)
                var a = $thisFormNew.find('[name="FusCustomer"]').val();
            //    alert(a);
                console.log("FF", a)
                // let $thisFormNew = $(ele).closest('[perfect-class="Form"]');
                //  alert($thisForm);
                // alert($thisFormNew);
                // alert($thisFormNew.find('[name="Servicefromdate"]').val());
                let $modal2 = $thisForm.find('#ProductServices');
                var NextActionID = $thisForm.find('[name="NextAction"]').val().split("+_"[0]);

                console.log("FF", NextActionID);

                let ServiceDetails = [];
                $modal2.find('tbody').find('tr').each(function () {
                    let Serviceinfo = {};
                    Serviceinfo['ID_Product'] = $(this).find('.jq_ProductServices_ID_Product').text();
                    Serviceinfo['ID_Services'] = $(this).find('.jq_ProductServices_ID_Services').text();
                    Serviceinfo['Services'] = $(this).find('.jq_Type_td').text();
                    Serviceinfo['Amount'] = $(this).find('.jq_ProductServicesAmnt_td').find('input').val();
                    Serviceinfo['Remarks'] = $(this).find('.jq_ProductServicesRemarks_td').find('input').val();
                    console.log('Serviceinfo', Serviceinfo);
                    ServiceDetails.push(Serviceinfo);

                });

                let $modal3 = $thisForm.find('#ProductDetails');
                let ProductDetails = [];
                $modal3.find('tbody').find('tr').each(function () {

                    //alert($(this).find('.jq_ProductDet_td').find('[type="checkbox"]').val());
                    let PrDetinfo = {};
                    PrDetinfo['ID_Product'] = $(this).find('.jq_ProductDet_td').find('[type="checkbox"]').val();
                    PrDetinfo['Quantity'] = $(this).find('.jq_ProductDetQty_td').find('input').val();
                    PrDetinfo['Amount'] = $(this).find('.jq_ProductDetAmnt_td').find('input').val();
                    PrDetinfo['ReplaceAmount'] = $(this).find('.jq_ProductDetReplaAmnt_td').find('input').val();
                    PrDetinfo['ChangeMode'] = $(this).find('.jq_ProductChangeMode_td').find('select').val();
                    PrDetinfo['ModelNo'] = $(this).find('.jq_ProductDetModelNO_td').find('input').val();
                    PrDetinfo['Remarks'] = $(this).find('.jq_ProductDetRemarks_td').find('input').val();
                    console.log('Prinfo', PrDetinfo);
                    ProductDetails.push(PrDetinfo);
                    if ($(this).find('.jq_ProductChangeMode_td').find('select').val() == 2) {
                        alert('hjg');
                        //let errorClass = '.temptableError';
                        //  $thisForm.closest('.PerError').find(errorClass).text('Field Required');
                        // alert('gh');
                        NotificationMessage({ 'type': 'warning', 'heading': 'warning', 'message': 'Already in stat', "settings": { "timeOut": "200000000" } });
                    }

                });
                let $modal4 = $thisForm.find('#ProductImageUpload');
                let ImageUpladDetails = [];
                $modal4.find('tbody').find('tr').each(function () {

                    
                    let PrImageinfo = {};
                  
                    PrImageinfo['ImagePath'] = $(this).find('#imgFiletemp').attr('src');
                   // PrImageinfo['ImagePathName'] = $(this).find('#imageUpladname').find('input').val();
                    PrImageinfo['ImagePathName'] = $(this).find('.jq_UploadImagename_td').find('input').val();
                    PrImageinfo['ID_Product'] = $(this).find('.jq_Image_ID_Product').text();
                    
                    ImageUpladDetails.push(PrImageinfo);
                      //  $(this).find('.imgFiletemp').find('input').val();
                   // console.log('PrImageinfo', PrImageinfo);
                    console.log('PrImageinfo', PrImageinfo);
                });
                let $modal5 = $thisForm.find('#ProductWarentyUpload');
                let DocUpladDetails = [];
                $modal5.find('tbody').find('tr').each(function () {


                    let PrDocinfo = {};

                    PrDocinfo['DocPath'] = $(this).find('#imgDocFiletemp').attr('src');
                    // PrImageinfo['ImagePathName'] = $(this).find('#imageUpladname').find('input').val();
                    PrDocinfo['DocPathName'] = $(this).find('.jq_DocImagename_td').find('input').val();
                    PrDocinfo['ID_Product'] = $(this).find('.jq_Doc_ID_Product').text();

                    DocUpladDetails.push(PrImageinfo);
                    //  $(this).find('.imgFiletemp').find('input').val();
                    // console.log('PrImageinfo', PrImageinfo);
                    console.log('DocUpladDetails', DocUpladDetails);
                });

                let inputData = {

                    __RequestVerificationToken: $('[name="__RequestVerificationToken"]').val(),
                    'ServiceFollowUpID': 0,
                    'FK_Customerserviceregister': $thisFormNew.find('[name="FK_Customerserviceregister"]').val(),
                    'FK_Employee': $thisFormNew.find('[name="FEmployee"]').val(),
                    'FK_Customer': $thisFormNew.find('[name="FusCustomer"]').val(), 
                    'StartingDate': $thisFormNew.find('[name="Servicefromdate"]').val(),
                    'Servicefromtime': $thisFormNew.find('[name="Servicefromtime"]').val(),
                    'Servicetotime': $thisFormNew.find('[name="Servicetotime"]').val(),
                    'AttendedMode': $thisFormNew.find('[name="AttendedMode"]').val(),
                    'CustomerNote': $thisForm.find('[name="CustomerNote"]').val(),
                    'EmployeeNote': $thisForm.find('[name="EmployeeNote"]').val(),
                    'ServiceAmount': $thisForm.find('[name="ServiceAmount"]').val(),
                    'ReplaceAmount': $thisForm.find('[name="ReplaceAmount"]').val(),
                    'ProductAmount': $thisForm.find('[name="ProductAmount"]').val(),
                    'TotalAmount': $thisForm.find('[name="TotalAmount"]').val(),
                    'DiscountAmount': $thisForm.find('[name="DiscountAmount"]').val(),
                    'NetAmount': $thisForm.find('[name="NetAmount"]').val(),
                    'NextAcMode': NextActionID,
                    'ServiceDetails': ServiceDetails,
                    'ProductDetails': ProductDetails,
                    'ImageUpladDetails': ImageUpladDetails,
                    'DocUploadDetails': DocUploadDetails 
                };
                console.log('save56', inputData)
                $.ajax({
                    url: "@Url.Action("ServiceFollowUpUpdate", "ServiceList")",
                    type: "POST",
                    data: inputData,
                    dataType: "json",
                    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                    success: function (ajaxOutput) {

                        if (ajaxOutput.Process.IsProcess) {

                            $.each(ajaxOutput.Process.Message, function (key, value) {
                                NotificationMessage({ 'type': 'success', 'heading': 'Success', 'message': value });
                            });

                            $thisForm.find('[perfect-ctype="select"]').val('').selectpicker('refresh');
                            $thisForm.find('[perfect-ctype="input"]').val('');
                            $thisForm.find('[perfect-ctype="date"]').val('');
                            $thisFormNew.find('[perfect-ctype="select"]').val('').selectpicker('refresh');
                            $thisFormNew.find('[perfect-ctype="input"]').val('');
                            $thisFormNew.find('[perfect-ctype="date"]').val('');




                            // Get the value set in form's perfect-onFormSuccess attribute
                            let onSuccess = $thisForm.attr('perfect-onFormSuccess')

                            if (onSuccess) {
                                window[onSuccess]();
                            }
                        }
                        else {
                            $.each(ajaxOutput.Process.Message, function (key, value) {
                                NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': value });
                            });
                        }
                    },
                    complete: function () {
                        $(ele).prop('disabled', false);
                    }

                });
            }
        }
    
    </script>
}
