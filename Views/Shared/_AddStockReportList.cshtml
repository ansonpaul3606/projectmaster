
<style>
    .Custominvalid {
        display: none;
        width: 100%;
        margin-top: 0.25rem;
        font-size: 80%;
        color: #FF6746;
    }
</style>
<div class="card ">
    <div class="card-header">
        <h4 class="card-title col-12">Product List@*<span class="badge light badge-success float-right" perfect-class="formTitle">REPORT</span>*@</h4>
    </div>
    <div class="card-body">
        <form id="" class="form-valide" perfect-class="form" action="#" method="post" perfect-onFormSuccess="">
            <div class="">
                @*@Html.AntiForgeryToken()*@
                <div class="row">

                    <div class="col-sm-6">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-4 col-form-label">
                                <span perfect-class="formGroupLabel">Report Name</span>
                                <span class="text-danger">*</span>
                            </label>
                            <div class="col-sm-8 ">
                                <input type="hidden" id="Companyname" name="Companyname" class="form-control" value="@Model.Companyname" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input" />
                                <select class="form-control Action ActionDate perfectValidate_string" id="ID_Report" name="ID_Report" data-id="ID_Report-error" perfect-class="formGroupControl" perfect-ctype="select" perfect-css="select" onchange="showandhidefield(this)">
                                    <option value="0">Please select</option>
                                    <option value="16">Product List</option>

                                </select>
                                <div id="ID_Report-error" class="Custominvalid animated fadeInUp producterror" style="display: none;">Please Select Report Name</div>
                            </div>
                        </div>
                    </div>




                    <div class="col-sm-6 Fieldsid">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-4 col-form-label ">
                                <span perfect-class="formGroupLabel">Report Fields</span>
                                <span class="text-danger">*</span>
                            </label>
                            <div class="col-sm-8">
                                <select class="form-control perfectValidate_string" placeholder="Select Report Fields" name="Reportfields" id="checkCategoriess" perfect-class="formGroupControl" perfect-ctype="select" perfect-css="select" data-live-search="true" multiple>

                                    @*<option value=""   selected disabled>Please Select</option>*@
                                    @if (!(Model.ActionStatusList is null))
                                    {
                                        foreach (var i in Model.ActionStatusList)
                                        {
                                            <option value="@i.ID_Mode">@i.ModeName</option>
                                        }
                                    }


                                </select>
                                <div class="Custominvalid animated fadeInUp producterror" id="ErrCategoriess" style="display: none;">Please Select Report Fields</div>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-6 DivFromDate">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-4 col-form-label">
                                <span perfect-class="formGroupLabel">From Date</span>
                                <span class="text-danger">*</span>
                            </label>
                            <div class="col-sm-8">
                                <input type="date" class="form-control ActionDate" id="FromDate" data-id="FromDate-error" name="FromDate" perfect-class="formGroupControl" max="2050-01-01" perfect-ctype="date" perfect-css="date" onchange="checkLimit(this)">
                                <div id="FromDate-error" class="Custominvalid animated fadeInUp producterror" style="display: none;">Please Select From Date</div>
                                <div class="invalid-feedback animated fadeInUp limit-check" style="display: block;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-6 DivToDate">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-4 col-form-label">
                                <span perfect-class="formGroupLabel">To Date</span>
                                <span class="text-danger">*</span>
                            </label>
                            <div class="col-sm-8">
                                <input type="date" class="form-control ActionDate" id="ToDate" data-id="ToDate-error" name="ToDate" perfect-class="formGroupControl" max="2050-01-01" perfect-ctype="date" perfect-css="date" onchange="checkLimit(this)">
                                <div class="invalid-feedback animated fadeInUp limit-check" style="display: block;"></div>
                                <div id="ToDate-error" class="Custominvalid animated fadeInUp producterror" style="display: none;">Please Select To Date</div>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-6 Divbranch">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-4 col-form-label">
                                <span perfect-class="formGroupLabel">Branch</span>
                                <input type="hidden" name="FK_BranchMode" class="form-control" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input" />
                            </label>
                            <div class="col-sm-8">
                                <select class="form-control perfectValidate_string_nm" id="BranchID" name="BranchID" perfect-class="formGroupControl" perfect-ctype="select" perfect-css="select" data-live-search="true" onchange="onchangeBranchclears(this)">

                                    <option value="">Please Select</option>


                                    @if (!(Model.BranchList is null))
                                    {
                                        foreach (var branchList in Model.BranchList)
                                        {
                                            <option value="@branchList.BranchID">@branchList.BranchName</option>
                                        }

                                    }

                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="col-sm-6 DivBranchTo">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-4 col-form-label">
                                <input type="hidden" name="FK_BranchMode" class="form-control" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input" />
                                <span perfect-class="formGroupLabel">Branch To</span>

                            </label>
                            <div class="col-sm-8">
                                <select class="form-control perfectValidate_string" id="BranchIDTo" name="BranchIDTo" perfect-class="formGroupControl" perfect-ctype="select" perfect-css="select" data-live-search="true" onchange="onchangeBranchclearsTo(this)">

                                    <option value="">Please Select </option>

                                    @if (!(Model.BranchListTo is null))
                                    {
                                        foreach (var branchListto in Model.BranchListTo)
                                        {
                                            <option value="@branchListto.BranchIDTo">@branchListto.BranchNameTo</option>
                                        }

                                    }

                                </select>

                            </div>

                        </div>
                    </div>


                    <div class="col-sm-6 DivDepartment">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-4 col-form-label">
                                <span perfect-class="formGroupLabel">Department</span>

                            </label>
                            <div class="col-sm-8">
                                <select class="form-control perfectValidate_string_nm" id="DepartmentID" name="DepartmentID" perfect-class="formGroupControl" perfect-ctype="select" perfect-css="select" data-live-search="true" onchange="clearemployee(this)">

                                    <option value="">Please Select</option>

                                    @if (!(Model.DepartmentList is null))
                                    {
                                        foreach (var deprtmnt in Model.DepartmentList)
                                        {
                                            <option value="@deprtmnt.DepartmentID">@deprtmnt.DepartmentName</option>
                                        }

                                    }
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 DivDepartmentTO">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-4 col-form-label">

                                <span perfect-class="formGroupLabel">Department To</span>

                            </label>
                            <div class="col-sm-8">
                                <select class="form-control perfectValidate_string" id="DepartmentIDTo" name="DepartmentIDTo" perfect-class="formGroupControl" perfect-ctype="select" perfect-css="select" data-live-search="true" onchange="clearemployeeTo(this)">

                                    <option value="">Please Select </option>

                                    @if (!(Model.DepartmentListTo is null))
                                    {
                                        foreach (var departmentListto in Model.DepartmentListTo)
                                        {
                                            <option value="@departmentListto.DepartmentIDTo">@departmentListto.DepartmentNameTo</option>
                                        }

                                    }

                                </select>

                            </div>

                        </div>
                    </div>

                    @*<div class="col-sm-6 DivEmployeeName">
                            <div class="form-group row" perfect-class="formGroup">
                                <label class="col-sm-4 col-form-label">

                                    <span perfect-class="formGroupLabel">Employee</span>

                                </label>

                                <div class="col-sm-8">
                                    <div class="input-group">
                                        <input type="text" class="form-control " name="Employee" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" disabled />
                                        <input type="hidden" id="EmployeeID" name="EmployeeID" class="perfectValidate_numeric_nm" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input" />
                                        <div class="input-group-append">

                                            <button id="employeefromid" class="btn btn-primary fa fa-search" type="button" perfect-css="button" onclick="GetCmnPopUpSearchValAssign(this,149,'Employee List',[],['FK_Branch','FK_Department'])" Criterea1="DepartmentID" Criterea2="BranchID" BindName="Employee" BindVal="EmployeeID"></button>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>*@
                    @if (ViewBag.Manager || ViewBag.Admin)
                    {
                        <div class="col-sm-6 DivEmployeeName">
                            <div class="form-group row" perfect-class="formGroup">
                                <label class="col-sm-4 col-form-label rptfilterfields">
                                    <span perfect-class="formGroupLabel">Employee Name</span>

                                </label>
                                <div class="col-sm-8">
                                    <div class="input-group">
                                        <input type="text" class="form-control rptfilters" name="Employee" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" placeholder="Select Employee" disabled />
                                        <input type="hidden" name="ID_FIELD" class="form-control" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input" />
                                        <div class="input-group-append">

                                            <button id="employeefromid" class="btn btn-primary fa fa-search" type="button" perfect-css="button" onclick="GetCmnPopUpSearchValAssign(this,149,'Employee List',[],['FK_Branch','FK_Department','ID_FIELD'])" Criterea1="DepartmentID" Criterea2="BranchID" BindName="Employee" BindVal="ID_FIELD"></button>

                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    }



                    else
                    {
                        <div class="col-sm-6 DivEmployeeName">
                            <div class="form-group row" perfect-class="formGroup">
                                <label class="col-sm-4 col-form-label rptfilterfields">
                                    <span perfect-class="formGroupLabel">Employee Name</span>
                                </label>
                                <div class="col-sm-8">
                                    <div class="input-group">

                                        <input type="text" class="form-control rptfilters" name="Employee" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" placeholder="Select Employee" value='@ViewBag.Employee' disabled />
                                        <input type="hidden" name="Employee_ID" class="form-control" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input" value='@ViewBag.FK_Employee' />

                                        <div class="input-group-append">

                                            <button id="employeefromid" class="btn btn-primary fa fa-search" type="button" perfect-css="button" onclick="GetCmnPopUpSearchValAssign(this,149,'Employee List',[],['FK_Branch','FK_Department'])" Criterea1="DepartmentID" Criterea2="BranchID" BindName="Employee" BindVal="EmployeeID" disabled></button>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    }


                    <div class="col-sm-6 DivEmployeeNameTo">
                        <div class="form-group2 row" perfect-class="formGroup">
                            <label class="col-sm-4 col-form-label">

                                <span perfect-class="formGroupLabel">Employee To</span>

                            </label>
                            <div class="col-sm-8">
                                <div class="input-group">
                                    <input type="text" class="form-control" name="EmployeeNameTo" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" disabled />
                                    <input type="hidden" id="EmployeeIDTo" name="EmployeeIDTo" class="perfectValidate_numeric_nm" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input" />
                                    <div class="input-group-append">

                                        <button id="addemployeestockto-jq-searchButton3" class="btn btn-primary fa fa-search" type="button" perfect-css="button" onclick="GetCmnPopUpSearchValAssign(this,37,'Employee List',[],['FK_Branch','FK_Department'])" Criterea1="DepartmentIDTo" Criterea2="BranchIDTo" BindName="EmployeeNameTo" BindVal="EmployeeIDTo" onchange="checkemployeeid"></button>

                                    </div>
                                </div>

                            </div>

                        </div>
                    </div>

                    <div class="col-sm-6 Divcategory">

                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-4 col-form-label">
                                <span perfect-class="formGroupLabel">Category</span>

                            </label>
                            <div class="col-sm-8 ">
                                <select class="form-control " id="CategoryID" name="CategoryID" perfect-class="formGroupControl" perfect-ctype="select" perfect-css="select" onchange="clearproducts(this)">
                                    <option value="">Please select</option>
                                    @if (!(Model.CategoryList is null))
                                    {
                                        foreach (var Action in Model.CategoryList)
                                        {
                                            <option value="@Action.CategoryID">@Action.CategoryName</option>
                                        }
                                    }

                                </select>
                            </div>
                        </div>

                    </div>

                    @*<div class="col-sm-6">
                            <div class="form-group row" perfect-class="formGroup">
                                <label class="col-sm-4 col-form-label">
                                    <span perfect-class="formGroupLabel">Mode</span>
                                    @*<span class="text-danger">*</span>
                                </label>
                                <div class="col-sm-8">


                                    <select class="form-control " id="Modes" name="Modes" perfect-selectButtonAction="testing" perfect-class="formGroupControl" perfect-ctype="select" perfect-css="select" onchange="clearproducts(this)">
                                        <option value="">Please Select </option>


                                        @if (!(Model.ModeList is null))
                                        {
                                            foreach (var Module in Model.ModeList)
                                            {
                                                <option value="@Module.Modes">@Module.ModeNames</option>
                                            }
                                        }
                                    </select>
                                    <span class="temptableError"></span>
                                </div>

                            </div>
                        </div>*@
                    <div class="col-sm-6 DivProduct">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-4 col-form-label">
                                <span perfect-class="formGroupLabel">Product</span>
                                @*<span class="text-danger">*</span>*@

                            </label>
                            <div class="col-sm-8">
                                <div class="input-group">
                                    <input type="text" class="form-control" name="Product" id="Prodt" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" disabled />
                                    <input type="hidden" id="ProductId" name="ProductID" class="form-control" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input" />


                                    <div class="input-group-append">
                                        @*<button id="" class="btn btn-primary fa fa-search" type="button" perfect-css="button" onclick="getproductdetails(this)"></button>*@
                                        <button id="addaccounthead-jq-searchButton3" class="btn btn-primary fa fa-search" type="button" perfect-css="button" onclick="GetCmnPopUpSearchValAssign(this,29,'Product Details',[],[])" Criterea1="CategoryID" BindName="Product" BindVal="ProductID"></button>
                                    </div>

                                    <div class="invalid-feedback animated fadeInUp error" style="display: block;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 DivOldProduct">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-4 col-form-label">
                                <span perfect-class="formGroupLabel">Old Product</span>

                            </label>
                            <div class="col-sm-8">
                                <div class="input-group">
                                    <input type="text" class="form-control" name="OldProduct" id="OldProdt" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" disabled />
                                    <input type="hidden" id="OldProductId" name="OldProductID" class="form-control" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input" />


                                    <div class="input-group-append">
                                        <button id="addaccounthead-jq-searchButton3" class="btn btn-primary fa fa-search" type="button" perfect-css="button" onclick="GetCmnPopUpSearchValAssign(this,29,'Product Details',[],[])" Criterea1="0" BindName="OldProduct" BindVal="OldProductID"></button>
                                    </div>

                                    <div class="invalid-feedback animated fadeInUp error" style="display: block;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 DivNewProduct">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-4 col-form-label">
                                <span perfect-class="formGroupLabel">New Product</span>

                            </label>
                            <div class="col-sm-8">
                                <div class="input-group">
                                    <input type="text" class="form-control" name="NewProduct" id="NewProdt" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" disabled />
                                    <input type="hidden" id="NewProductId" name="NewProductID" class="form-control" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input" />


                                    <div class="input-group-append">
                                        <button id="addaccounthead-jq-searchButton3" class="btn btn-primary fa fa-search" type="button" perfect-css="button" onclick="GetCmnPopUpSearchValAssign(this,29,'Product Details',[],[])" Criterea1="0" BindName="NewProduct" BindVal="NewProductID"></button>
                                    </div>

                                    <div class="invalid-feedback animated fadeInUp error" style="display: block;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 DivGrouping">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-4 col-form-label rptfilterfields ">
                                <span perfect-class="formGroupLabel">Grouping</span>

                            </label>
                            <div class="col-sm-8">

                                <select class="form-control rptfilters" name="Criteria" perfect-class="formGroupControl" perfect-ctype="select" perfect-css="select">

                                    <option value="">Please select</option>


                                </select>
                            </div>
                        </div>
                    </div>
                    @*<div class="col-sm-6 DivCriteria">
                            <div class="form-group row" perfect-class="formGroup">
                                <label class="col-sm-4 col-form-label">
                                    <span perfect-class="formGroupLabel">Grouping</span>
                                    <span class="text-danger"></span>
                                </label>
                                <div class="col-sm-8 ">

                                    <select class="form-control" id="Criteria" name="Criteria" perfect-class="formGroupControl" perfect-ctype="select" perfect-css="select">
                                        <option value="">Please select</option>

                                        <option value="1">Branch</option>
                                        <option value="2">Department</option>
                                        <option value="3">Category</option>
                                        <option value="4">Product</option>
                                        <option value="5">Employee</option>


                                    </select>
                                </div>
                            </div>
                        </div>*@
                    <div class="col-sm-6 Divreport">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-4 col-form-label">
                                <span perfect-class="formGroupLabel">Report Format</span>
                                <span class="text-danger">*</span>
                            </label>
                            <div class="col-sm-8">
                                <select class="form-control perfectValidate_numeric" id="Reporttype" name="Reporttype" perfect-class="formGroupControl" perfect-ctype="select" perfect-css="select">

                                    @*<option value="">Please Select</option>*@
                                    <option value="1" selected>PDF</option>
                                    <option value="2">Excel</option>

                                </select>
                            </div>
                        </div>
                    </div>
                </div>


            </div>
            <div class="card-footer text-right" perfect-class="formFooter">
                <button id="addcompany-jq-addnewuser" type="button" class="btn btn-primary mr-3 " name="add" perfect-css="button" onclick="ShowReport(this)"><i class="fa fa-refresh fa-spin loaderClass "></i>Show</button>
                <button type="button" class="btn btn-light" perfect-css="button" onclick="ResetButton(this)" name="reset">Clear</button>
            </div>

            <div id="divReportSection">


            </div>

        </form>
    </div>


</div>

<script>
    (function () {
        // jQuery('form').validate();//<----- Validate/initialize our form on page load
        $('select').selectpicker();
        //$('.Fieldsid').hide();
    })();


    $(document).ready(function () {
        debugger
        console.log('FK_Employee', @ViewBag.FK_Employee)
        showandhidefield(this);
        Getdepartmentdefault(this);
       
    });

       function fn_selectFieldlistgrouping(ele)
       {
           debugger
           let $thisForm = $(ele).closest('[perfect-class="form"]');
           //console.log('Mode1', $thisForm.find('[name="ModeNames"]'));
           var modes;

           if ($("#ID_Report").val() == 5) { modes = 37; }
           else if ($("#ID_Report").val() == 6) { modes = 38; }
           else if ($("#ID_Report").val() == 7) { modes = 37; }
           else if ($("#ID_Report").val() == 12) { modes = 42; }
           else if ($("#ID_Report").val() == 16) { modes = 94; }
           else if ($("#ID_Report").val() == '') { modes = 37; }
           else {
               modes =0;
           }

           var mode = { mode: modes }
           var $actionDropdown = $thisForm.find('[name="Criteria"]');
           $actionDropdown.empty();
           $actionDropdown.append($('<option/>', { value: '' }).text('Please select')).selectpicker('refresh');
           console.log('modes', mode);
           debugger
           $.ajax({
            url: "@Url.Action("getModeCriteriaList", "StockReportList")",
            type: "POST",
            dataType: "json",
               data: mode,
            contentType: 'application/x-www-form-urlencoded; charset=utf-8',
            success: function (ajaxOutput) {
                if (ajaxOutput.length > 0) {
                    $.each(ajaxOutput, function (key, value) {
                        $actionDropdown.append($('<option/>', { value: value.ID_Mode }).text(value.ModeName)).selectpicker('refresh');
                    });
                    if ($actionDropdown.attr('perfect-onloadSelect')) {
                        $actionDropdown.val($actionDropdown.attr('perfect-onloadSelect')).selectpicker('refresh')
                    }
                }
                else {
                    $.each(ajaxOutput.Process.Message, function (key, value) {
                        NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': value });
                    });
                }
            }
        });


    }


    function showandhidefield(element) {
        let $thisForm = $(element).closest('[perfect-class="form"]');
        fn_selectFieldlistgrouping(element)
        if ($("#ID_Report").val() == 5) {

            $('.DivFromDate').hide();
            $('.DivToDate').hide();
            $('.DivDepartment').show();
            $('.DivEmployeeName').hide();
            $('.DivGrouping').show();
            $('.Divcategory').show();
            $('.DivBranchTo').hide();
            $('.DivDepartmentTO').hide();
            $('.DivEmployeeNameTo').hide();
            $('.DivOldProduct').hide();
            $('.DivNewProduct').hide();
            $('.DivProduct').hide();
            $('.Fieldsid').hide();
        }
        else if ($("#ID_Report").val() == 6) {

            $('.DivFromDate').hide();
            $('.DivToDate').hide();
            $('.DivDepartment').hide();
            $('.DivEmployeeName').show();
            $('.DivGrouping').show();
            $('.Divcategory').show();
            $('.DivBranchTo').hide();
            $('.DivDepartmentTO').hide();
            $('.DivEmployeeNameTo').hide();
            $('.DivOldProduct').hide();
            $('.DivNewProduct').hide();
            $('.DivProduct').hide();
            $('.Fieldsid').hide();
        }
        else if ($("#ID_Report").val() == 12) {

            $('.DivFromDate').show();
            $('.DivToDate').show();
            $('.DivDepartment').show();
            $('.DivEmployeeName').hide();
            $('.DivGrouping').show();
            $('.Divcategory').hide();
            $('.DivBranchTo').hide();
            $('.DivDepartmentTO').hide();
            $('.DivEmployeeNameTo').hide();
            $('.DivOldProduct').hide();
            $('.DivNewProduct').hide();
            $('.DivProduct').show();
            $('.Fieldsid').hide();
        }
        else if ($("#ID_Report").val() == 11) {

            $('.DivFromDate').show();
            $('.DivToDate').show();
            $('.DivDepartment').show();
            $('.DivEmployeeName').hide();
            $('.DivGrouping').hide();
            $('.Divcategory').hide();
            $('.DivBranchTo').hide();
            $('.DivDepartmentTO').hide();
            $('.DivEmployeeNameTo').hide();
            $('.DivOldProduct').hide();
            $('.DivNewProduct').hide();
            $('.DivProduct').show();
            $('.Fieldsid').hide();

        }
        else if ($("#ID_Report").val() == 13) {

            $('.DivFromDate').show();
            $('.DivToDate').show();
            $('.DivDepartment').show();
            $('.DivBranchTo').show();
            $('.DivDepartmentTO').show();
            $('.DivEmployeeNameTo').show();
            $('.DivEmployeeName').show();
            $('.DivGrouping').hide();
            $('.Divcategory').hide();
            $('.DivOldProduct').hide();
            $('.DivNewProduct').hide();
            $('.DivProduct').hide();
            $('.Fieldsid').hide();
        }
        else if ($("#ID_Report").val() == 15) {

            $('.DivFromDate').show();
            $('.DivToDate').show();
            $('.DivDepartment').show();
            $('.DivBranchTo').hide();
            $('.DivDepartmentTO').hide();
            $('.DivEmployeeNameTo').hide();
            $('.DivEmployeeName').hide();
            $('.DivGrouping').hide();
            $('.Divcategory').hide();
            $('.DivProduct').hide();
            $('.DivOldProduct').show();
            $('.DivNewProduct').show();
            $('.Fieldsid').hide();
        }
        else if ($("#ID_Report").val() == 16) {

            $('.DivDepartment').hide();
            $('.DivFromDate').hide();
            $('.DivToDate').hide();
            $('.DivGrouping').show();
            $('.Divcategory').show();
            $('.DivEmployeeName').hide();
            $('.DivBranchTo').hide();
            $('.DivDepartmentTO').hide();
            $('.DivEmployeeNameTo').hide();
            $('.DivOldProduct').hide();
            $('.DivNewProduct').hide();
            $('.DivProduct').show();
            $('.Divbranch').hide();
            $('.Divreport').hide();
            $('.Fieldsid').show();
        }
        else {

            $('.DivDepartment').show();
            $('.DivFromDate').show();
            $('.DivToDate').show();
            $('.DivGrouping').show();
            $('.Divcategory').show();
            $('.DivEmployeeName').hide();
            $('.DivBranchTo').hide();
            $('.DivDepartmentTO').hide();
            $('.DivEmployeeNameTo').hide();
            $('.DivOldProduct').hide();
            $('.DivNewProduct').hide();
            $('.DivProduct').hide();
            $('.Fieldsid').hide();
        }

        $thisForm.find('[name=Product]').closest('[perfect-class="formGroup"]').find('.error').text('');

    }




    function clearproducts(ele) {
        let $thisForm = $(ele).closest('[perfect-class="form"]');
        $thisForm.find('[name=ProductID]').val(0);
        $thisForm.find('[name=Product]').val('');
    }

    function onchangeBranchclears(ele) {

        let $thisForm = $(ele).closest('[perfect-class="form"]');
        $thisForm.find('[name=DepartmentID]').val(0);
        $thisForm.find('[name=DepartmentName]').val('');
         let user = '@ViewBag.Admin';
        let manager = '@ViewBag.Manager';
        if (user == 'True' || manager == 'True') {
            $thisForm.find('[name="Employee"]').val('');
            $thisForm.find('[name="Employee_ID"]').val('');
        }
        else
        {
            $thisForm.find('[name="Employee"]').val('@ViewBag.Employee');
            $thisForm.find('[name="Employee_ID"]').val('@ViewBag.FK_Employee');
        }
        $thisForm.find('[name=EmployeeID]').val(0);
        $thisForm.find('[name=Employee]').val('');
    }
    function onchangeBranchclearsTo(ele) {

        let $thisForm = $(ele).closest('[perfect-class="form"]');
        $thisForm.find('[name=DepartmentIDTo]').val(0);
        $thisForm.find('[name=DepartmentNameTo]').val('');
        $thisForm.find('[name=EmployeeIDTo]').val(0);
        $thisForm.find('[name=EmployeeNameTo]').val('');
    }
    function clearemployee(ele) {

        let $thisForm = $(ele).closest('[perfect-class="form"]');
        $thisForm.find('[name=EmployeeID]').val(0);
        $thisForm.find('[name=Employee]').val('');
    }
    function clearemployeeTo(ele) {

        let $thisForm = $(ele).closest('[perfect-class="form"]');
        $thisForm.find('[name=EmployeeIDTo]').val(0);
        $thisForm.find('[name=EmployeeNameTo]').val('');
    }


    function checkLimit(ele) {
        let $thisForm = $(ele).closest('[perfect-class="form"]');
        //invalid-feedback
        let Fromdate = $thisForm.find('[name="FromDate"]').val();
        let Todate = $thisForm.find('[name="ToDate"]').val();
        let mindate = "1899/12/31";
        mindate = new Date(mindate);
        mindate.setHours(0, 0, 0, 0)

        Fromdate = new Date(Fromdate);
        Fromdate.setHours(0, 0, 0, 0)

        Todate = new Date(Todate);
        Todate.setHours(0, 0, 0, 0)
        debugger
        if (Todate < Fromdate) {

            console.log('inside limit check if')
            $thisForm.find('[name="ToDate"]').closest('[perfect-class="formGroup"]').find('.limit-check').text('To Date should be greater than  From Date');
            return false;
        }
        else if (Todate < mindate ) {
            $thisForm.find('[name="ToDate"]').closest('[perfect-class="formGroup"]').find('.limit-check').text('Enter a Valid Date');
            return false;
        }
        else if (Fromdate < mindate ) {
            $thisForm.find('[name="FromDate"]').closest('[perfect-class="formGroup"]').find('.limit-check').text('Enter a Valid Date');
            return false;
        }
        else {

            console.log('inside limit check else')
            $thisForm.find('[name="ToDate"]').closest('[perfect-class="formGroup"]').find('.limit-check').text('')
            $thisForm.find('[name="FromDate"]').closest('[perfect-class="formGroup"]').find('.limit-check').text('');
            return true;
        }


    }


    function ShowReport(ele) {
        debugger
        let $thisForm = $(ele).closest('[perfect-class="form"]');
        let isValid = true;
        let pdt = $thisForm.find('[name="ProductID"]').val();
        if ((($('#ID_Report').val() == 12) || ($('#ID_Report').val() == 11)) && (pdt == "")) {
            isValid = false;
            $thisForm.find('[name=Product]').closest('[perfect-class="formGroup"]').find('.error').text('Please Select Product');

        }
        else {
            isValid = true;
            $thisForm.find('[name=Product]').closest('[perfect-class="formGroup"]').find('.error').text('');

        }
        if (($('#ID_Report').val() == 16)){

            if (!CustomeValidtion()) { return}
        }

        if (ValidateAddrepdetails($('#ID_Report').val()) <= 0 && isValid == true) {
            debugger
            var datval = true;
            if (($('#ID_Report').val() == 7) || ($('#ID_Report').val() == 11) || ($('#ID_Report').val() == 12) || ($('#ID_Report').val() == 13) || ($('#ID_Report').val() == 15)) {
                datval = checkLimit(ele);
                console.log('DATE', datval);
            }

            if (datval ) {


                $("#divReportSection").html('');
                groupBy = $('select[name="ProdRptCriteria"] option:selected').text();

                if ($('select[name="ID_Report"] option:selected').val() != "3") {

                    $thisForm.find('[name=Lead]').removeClass("perfectValidate_numeric");
                    $thisForm.find('[name=LeadNo]').removeClass("perfectValidate_numeric");
                } else {
                    $thisForm.find('[name=FromDate]').removeClass("perfectValidate_date");
                    $thisForm.find('[name=FromDate]').removeClass("perfectValidate_date");
                }
                var critria_ = "";
                if ($('select[name="ID_Report"] option:selected').val() == "6" || $('select[name="ID_Report"] option:selected').val() == "7") {

                    critria_ = $thisForm.find('[name=ProdRptCriteria]').val();
                }
                else {
                    critria_ = $thisForm.find('[name=Criteria]').val();
                }
                var selectElement = document.getElementById('checkCategoriess');
                var selectedValues = Array.from(selectElement.selectedOptions).map(option => option.value);

                var Report_Id = $('#ID_Report').val();
                var Fromdate = $('#FromDate').val() == null ? null : $('#FromDate').val();

                var Todate = $('#ToDate').val();
                // var Employee = $thisForm.find('[name="FK_LgCollectedBy"]').val();
                var Branch = $('#BranchID').val();
                var Branchname = $('#BranchID :selected').text();
                var BranchTo = $('#BranchIDTo').val();
                var BranchnameTo = $('#BranchIDTo :selected').text();

                var FK_Department = $('#DepartmentID').val();
                var Departmentname = $('#DepartmentID :selected').text();
                var FK_DepartmentTo = $('#DepartmentIDTo').val();
                var DepartmentnameTo = $('#DepartmentIDTo :selected').text();


                var FK_Category = $('#CategoryID').val();
                var Categoryname = $('#CategoryID :selected').text();
                var Mode = $('#Modes').val();
                var Modename = $('#Modes :selected').text();
                var FK_Product = $thisForm.find('[name="ProductID"]').val();
                var product = $thisForm.find('[name="Product"]').val();

                var NewProductId = $thisForm.find('[name="NewProductID"]').val();
                var Newproduct = $thisForm.find('[name="NewProduct"]').val();

                var OldProductId = $thisForm.find('[name="OldProductID"]').val();
                var Oldproduct = $thisForm.find('[name="OldProduct"]').val();

                var Employee = $thisForm.find('[name="EmployeeID"]').val();
                var Employeename = $thisForm.find('[name="Employee"]').val();

                var EmployeeTo = $thisForm.find('[name="EmployeeIDTo"]').val();
                var EmployeenameTo = $thisForm.find('[name="EmployeeNameTo"]').val();

                var crtireanam = $thisForm.find('[name="Criteria"] option:selected').text();
                var Reportformat = $('#Reporttype').val();
                var Company = $thisForm.find('[name="Companyname"]').val();
                //  var Criteria = $('#Criteria').val();
                var Criteria = $thisForm.find('[name="Criteria"]').val();







                let columnCount = 0;
                let inputData = {
                    __RequestVerificationToken: $('[name="__RequestVerificationToken"]').val(),
                    ReportMode: Report_Id,
                    FromDate: Fromdate,
                    ToDate: Todate,
                    FK_Branch: Branch,
                    FK_Product: FK_Product,
                    FK_BranchTo: BranchTo,
                    CompName: Company,
                    Branchname: Branchname,
                    BranchnameTo: BranchnameTo,
                    Prodname: product,
                    FK_Category: FK_Category,
                    Categoryname: Categoryname,
                    FK_Department: FK_Department,
                    FK_DepartmentTo: FK_DepartmentTo,
                    Departmentname: Departmentname,
                    DepartmentnameTo: DepartmentnameTo,
                    Rptype: "",
                    Modes: Mode,
                    Critername: crtireanam,
                    Criteria: Criteria,
                    Modename: Modename,
                    FK_Employee: Employee,
                    Employeename: Employeename,
                    FK_EmployeeTo: EmployeeTo,
                    EmployeenameTo: EmployeenameTo,
                    product: product,
                    FK_ProductNew: NewProductId,
                    FK_ProductOld: OldProductId,
                    ProductNew: Newproduct,
                    ProductOld: Oldproduct,
                    //Criteria: critria_,
                    ActionlistArray: selectedValues




                };


                let pageUrl = '@Url.Action("GetStockReport2", "Report")';
                $.ajax({
                    url: pageUrl,
                    type: "POST",
                    data: inputData,
                    dataType: "json",
                    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                    success: function (ajaxOutput) {

                        var rptmode = $('select[name="ID_Report"] option:selected').val();

                        $("#divReportSection").load('@Url.Action("ShowReport", "Report")?rptMode=' + rptmode, function () {
                        });
                    }
                });

            }
        }


    }




    function popitup(url) {
        newwindow = window.open(url, 'name', 'height=1000,width=1000');
        if (window.focus) { newwindow.focus() }
        return false;
    }
    function fireDownload(url) {
        window.location.assign(url);
    }

    function ResetButton(ele) {
        StocklistreportInitialLoadAddForm()
        $('.Fieldsid').hide();



    }
    function Getdepartmentdefault() {

        debugger
        let $thisForm = $('[perfect-class="form"]');
        $.ajax({
            url: '@Url.Action("GetEmployeeLeadDefault", "ServiceReport")',
            type: "Get",
            dataType: "json",
            contentType: "application/json",
            success: function (ajaxOutput) {//<----- if ajax method executed succesfully,  we get the data passed from controller in this variable  => success: function (variable) {

                if (ajaxOutput.Process.IsProcess) {
                    //var stateModel = createSelectList({ data: ajaxOutput.Data, hideColumn: ['EmpID'] });
                    $.each(ajaxOutput.Data, function (key, value) {

                        console.log('>_ Search button > list click', value);

                        //$thisForm.find('[name=BranchTypeID]').val(value.ID_BranchType).selectpicker('refresh');
                        $thisForm.find('[name=BranchID]').val(value.ID_Branch).selectpicker('refresh');
                        $thisForm.find('[name=DepartmentID]').val(value.FK_Department).selectpicker('refresh');
                        $thisForm.find('[name=FK_BranchMode]').val(value.FK_BranchMode);

                        let Mode = $thisForm.find('[name=FK_BranchMode]').val();
                        let user = '@ViewBag.Admin';

                        console.log('user', user);
                        if (parseFloat(Mode) == 1 && user == 'True') {
                            $thisForm.find('[name=BranchID]').val(value.ID_Branch).selectpicker('refresh');

                            $('#BranchID').prop('disabled', false);
                        }
                        else {
                            $('#BranchID').prop('disabled', true);
                        }


                    });




                }
                else {
                    $.each(ajaxOutput.Process.Message, function (key, value) {
                        NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': value });
                    });
                }

            },


        });
    }






    function ValidateAddrepdetails(Rptval) {

        var Error = 0;
        let $inp;

        debugger
        if (Rptval == 7 || Rptval == 11 || Rptval == 12 || Rptval == 13 || Rptval== 15) { $inp = $(".ActionDate"); }

        else { $inp = $(".Action"); }
        let is_empty;

        $inp.each((i, el) => {


            if (!$('[name=' + $(el).attr('name') + ']').val() == undefined) {
                is_empty = false;

            }
            else {
                if ($('[name=' + $(el).attr('name') + ']').val() == 0 || $('[name=' + $(el).attr('name') + ']').val() == "") {
                    is_empty = true;
                }
                else {


                    is_empty = !$('[name=' + $(el).attr('name') + ']').val();
                }

            }


            let ErrorID = $(el).attr('data-id');

            if (ErrorID != undefined) {
                if (is_empty) {

                    $('#' + ErrorID).css('display', 'block');
                    Error++;

                }
                else if (!is_empty) {
                    $('#' + ErrorID).css('display', 'none');

                }
                el.classList.toggle("is-empty", is_empty);
            }
        });

        return Error;
    }

    function CustomeValidtion() {
        debugger
        const validcheck = $('#checkCategoriess').val();
        if (validcheck.length > 0) { $('#ErrCategoriess').hide(); return true };
        $('#ErrCategoriess').show();
        return false

    }



</script>
