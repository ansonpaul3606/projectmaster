@model PerfectWebERP.Models.DeliveryAssignmentModel.DeliveryAssignmentview
<div class="card ">
    <div class="card-header">
        <h4 class="card-title col-12">@ViewBag.PageTitle</h4>
        <span title="To View List" onclick="fn_showListView();"><svg id="Layer_1" class="layer" stroke="currentColor" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 122.88 122.54"><title>To View List</title><path class="viewlst" d="M4.69,0H46.22a4.71,4.71,0,0,1,4.69,4.69V46a4.69,4.69,0,0,1-4.69,4.69H4.69a4.65,4.65,0,0,1-3.31-1.38l-.09-.09A4.67,4.67,0,0,1,0,46V4.69A4.71,4.71,0,0,1,4.69,0ZM89.44,61.94a26.56,26.56,0,0,1,10.18,2l.07,0a26.61,26.61,0,0,1,15.25,32.16,26.18,26.18,0,0,1-2.7,6.11l10.3,11.24a1.27,1.27,0,0,1-.07,1.8l-7.57,6.9a1.27,1.27,0,0,1-1.79-.07l-9.86-10.85a26.36,26.36,0,0,1-6.1,2.74,26.87,26.87,0,0,1-7.71,1.13,26.51,26.51,0,0,1-10.17-2l-.07,0A26.64,26.64,0,0,1,64.85,78.37l0-.07A26.6,26.6,0,0,1,89.44,61.94Zm15,11.59a21.38,21.38,0,0,0-6.89-4.61l-.06,0a21.22,21.22,0,0,0-23.07,4.64l-.07.07a21.25,21.25,0,0,0-4.54,6.83l0,.06a21.32,21.32,0,0,0-1.58,8.06,21.26,21.26,0,0,0,29.35,19.62,21.54,21.54,0,0,0,6.89-4.61l.07-.07a21.09,21.09,0,0,0,4.54-6.83l0-.06a21.35,21.35,0,0,0,0-16.17,21.34,21.34,0,0,0-4.62-6.9ZM4.69,63.2H46.22a4.71,4.71,0,0,1,4.69,4.7v41.34a4.68,4.68,0,0,1-4.69,4.69H4.69A4.69,4.69,0,0,1,0,109.24V67.9a4.71,4.71,0,0,1,4.69-4.7ZM68.78,0h41.53A4.71,4.71,0,0,1,115,4.69V46a4.71,4.71,0,0,1-4.69,4.69H68.78A4.71,4.71,0,0,1,64.09,46V4.69a4.69,4.69,0,0,1,1.37-3.31l.1-.09A4.67,4.67,0,0,1,68.78,0Z"></path></svg></span>
    </div>
    <div class="card-body">
        <form id="" class="form-valide" perfect-class="form" action="#" method="post" perfect-onFormSuccess="">
            <div class="">
                @Html.AntiForgeryToken()
                <div class="row">
                    <div class="col-sm-4">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-5 col-form-label">
                                <span perfect-class="formGroupLabel">Import From</span>
                                <input type="hidden" id="DeliveryAssignmentid" name="ID_DeliveryAssignment" />
                                <span class="text-danger">*</span>
                            </label>
                            <div class="col-sm-7">
                                <div class="input-group">

                                    <select class="form-control perfectValidate_string" id="ddlImportsList" name="ddlImportsList" perfect-class="formGroupControl" perfect-ctype="select" perfect-css="select">
                                        <option value="">Please Select</option>
                                        <option value="1">Sales</option>
                                        <option value="2">Sales Order</option>
                                    </select>

                                    <div class="input-group-append">
                                        <button id="btnShowList" data-toggle="tooltip" data-placement="top" data-html="true" title="Import from Sales or Sales Order" class="btn btn-primary" type="button" perfect-css="button" onclick="fn_showDeliveryAssignmentImportList(this)" Criterea1="0" Criterea2="0" Function="2"><i class="las la-file-import la-lg"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-5 col-form-label">
                                <span perfect-class="formGroupLabel">Reference No</span>
                                <input type="hidden" id="ID_SalesOrder" name="ID_SalesOrder" />
                                <input type="hidden" id="ID_Sales" name="ID_Sales" />
                            </label>
                            <div class="col-sm-7">
                                <input type="text" class="form-control" name="DAReferenceNo" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" readonly />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-5 col-form-label">
                                <span perfect-class="formGroupLabel">Date</span>
                            </label>
                            <div class="col-sm-7">
                                <input type="date" class="form-control" name="DADate" perfect-class="formGroupControl" perfect-ctype="date" perfect-css="date" readonly />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-4">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-5 col-form-label">
                                <span perfect-class="formGroupLabel">Customer Name</span>
                            </label>
                            <div class="col-sm-7">
                                <input type="text" class="form-control perfectValidate_string" name="DACustomer" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" readonly />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-5 col-form-label">
                                <span perfect-class="formGroupLabel">Mobile</span>
                            </label>
                            <div class="col-sm-7">
                                <input type="text" class="form-control" name="Mobile" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" readonly />
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="form-group row" perfect-class="formGroup">
                            <label class="col-sm-5 col-form-label">
                                <span perfect-class="formGroupLabel">Address</span>
                            </label>
                            <div class="col-sm-7">
                                <input type="text" class="form-control" name="Address" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" readonly />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <div class="daccordion__header">
                            <span class="accordion__header--text">Product Details</span>
                        </div>

                        <div class="row">
                            <div class="col-sm-12 " perfect-class="TempTableProduct">

                                <div class="row">
                                    <div class="col-sm-12" style="padding-right:25px;padding-left:25px;">
                                        <div class="form-group row" perfect-class="formGroup">
                                            <div class="table-responsive" perfect-tempTable-lastindex="0" perfect-tempTable-action="0">
                                                <div id="DataTables_Table_2_wrapper" class="dataTables_wrapper no-footer">
                                                    <table class="table mb-0 table-hover table-striped text-black dataTable no-footer" id="pdid" role="grid">
                                                        <thead class="thead-primary">
                                                            <tr class="btn-reveal-trigger" role="row">
                                                                <th class="py-2 sorting_disabled" rowspan="1" colspan="1" style="width: 10%;"></th>
                                                                <th class="py-2 pf_tableHeadMaxW sorting_disabled" rowspan="1" colspan="1" style="width: 70%;">Product</th>
                                                                <th class="py-2 pf_tableHeadMaxW sorting_disabled" rowspan="1" colspan="1" style="width: 70%;" hidden></th>
                                                                <th class="py-2 pf_tableHeadMaxW sorting_disabled" rowspan="1" colspan="1" style="width: 20%;">Qty</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody id="tbodyDeliveryAssignment">
                                                            <tr id="0">
                                                                <td colspan="4" style="text-align:center;">No Records...</td>
                                                            </tr>
                                                        </tbody>
                                                        @*<tbody id="tbodyDeliveryAssignment">

                                                                                <tr class="btn-reveal-trigger odd" quotationindex="1" role="row">
                                                                <td class="py-2 text-center"><input type="checkbox" /></td>
                                                                <td class="py-2 text-left">Tesla Car</td>
                                                                <td class="py-2 text-left"><input type="text" /></td>
                                                            </tr>
                                                            <tr class="btn-reveal-trigger even" quotationindex="1" role="row">
                                                                <td class="py-2 text-center"><input type="checkbox" /></td>
                                                                <td class="py-2 text-left">Tesla Car 323232</td>
                                                                <td class="py-2 text-left"><input type="text" /></td>
                                                            </tr>
                                                            <tr class="btn-reveal-trigger odd" quotationindex="1" role="row">
                                                                <td class="py-2 text-center"><input type="checkbox" /></td>
                                                                <td class="py-2 text-left">Tesla Car 2333333333333333333333333333333333333333333333333333</td>
                                                                <td class="py-2 text-left"><input type="text" /></td>
                                                            </tr>
                                                                            </tbody>*@
                                                    </table>
                                                </div>
                                            </div>
                                        </div>

                                    </div>


                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">

                    <div class="col-sm-12">
                        <div class="daccordion__header">
                            <span class="accordion__header--text">Assign To</span>
                        </div>
                        <br />
                        <div class="row">
                            <div class="col-sm-4">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-5 col-form-label">
                                        <span perfect-class="formGroupLabel">Vehicle</span>
                                        <span class="text-danger">*</span>
                                    </label>
                                    <div class="col-sm-7">
                                        <div class="input-group">
                                            <input type="text" class="form-control perfectValidate_string" name="VehicleName" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input"/>
                                            <input type="hidden" id="BranchID" name="BranchID" value="@ViewBag.BranchID" />
                                            <input type="hidden" name="VehicleID" class="form-control" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input"/>
                                            <div class="input-group-append">

                                                <button id="addvehicle-jq-searchButton3" class="btn btn-primary fa fa-search" type="button" perfect-css="button" onclick="GetCmnPopUpSearchVal(this,116,'Vehicle List',['','Vehicle'],'@ViewBag.TransMode')" Criterea1="BranchID" Criterea2="0" BindName="VehicleName" BindVal="VehicleID" Function="1"></button>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-5 col-form-label">
                                        <span perfect-class="formGroupLabel">Employee</span>
                                        <span class="text-danger">*</span>
                                    </label>
                                    <div class="col-sm-7">
                                        <div class="input-group">
                                            <input type="text" class="form-control" name="Employee" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" readonly />
                                            <input type="hidden" name="EmployeeID" class="perfectValidate_numeric" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input" />
                                            <div class="input-group-append">

                                                <button id="addemployee-jq-searchButton3" class="btn btn-primary fa fa-search" type="button" perfect-css="button" onclick="GetCmnPopUpSearchValAssign(this,37,'Employee List',[],['FK_Branch','FK_Department'],'@ViewBag.TransMode')" Criterea1="0" Criterea2="BranchID" BindName="Employee" BindVal="EmployeeID"></button>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-4 col-form-label">
                                        <span perfect-class="formGroupLabel">Delivery Date/Time</span>
                                        <span class="text-danger">*</span>
                                    </label>
                                    <div class="col-sm-8">
                                        <div class="input-group">
                                            <input type="date" class="form-control perfectValidate_date" id="DeliveryDate" name="DeliveryDate" perfect-class="formGroupControl" perfect-ctype="date" perfect-css="date"/>
                                            <input type="time" class="form-control" name="DeliveryTime" perfect-class="formGroupControl" perfect-ctype="time" perfect-css="time"/>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>

                <div class="row">
                    <div class="col-sm-12">
                        <div class="daccordion__header">
                            <span class="accordion__header--text">Delivery Details</span>
                        </div>
                        <br />
                        <div class="row" style="margin-top:1.5rem;">

                            <div class="col-sm-6">
                                <div class="form-group row" perfect-class="formGroup">

                                    <div class="col-sm-5">
                                        <div class="form-check form-check-inline" perfect-class="formCheck">
                                            <label class="form-check-label" perfect-class="formCheckLabel">
                                                <input type="checkbox" class="form-check-input" name="Checkboxsame" id="Checkboxsame" perfect-class="formCheckInput" perfect-ctype="checkbox" onchange="loadcustomeraddress(this)" perfect-css="checkbox">Same Address
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6"></div>
                            <div class="col-sm-4">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-5 col-form-label">
                                        <span perfect-class="formGroupLabel">Name</span>

                                    </label>
                                    <div class="col-sm-7">
                                        <div class="input-group">

                                            <input type="text" class="form-control perfectValidate_string_nm psscapitalize" placeholder="" name="ShpContactName" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" maxlength="150" />
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-5 col-form-label">
                                        <span perfect-class="formGroupLabel">House Name</span>

                                    </label>
                                    <div class="col-sm-7">

                                        <div class="input-group">

                                            <input type="text" class="form-control perfectValidate_string_nm psscapitalize" autocomplete="off" placeholder="Enter House Name" name="Address1" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" maxlength="150" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-5 col-form-label">
                                        <span perfect-class="formGroupLabel">Place</span>
                                    </label>
                                    <div class="col-sm-7">

                                        <div class="input-group">

                                            <input type="text" class="form-control perfectValidate_string_nm psscapitalize" autocomplete="off" placeholder="Enter Place" name="Address2" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" maxlength="150" />
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-4">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-5 col-form-label">
                                        <span perfect-class="formGroupLabel">PinCode</span>
                                    </label>
                                    <div class="col-sm-7">
                                        <div class="input-group">
                                            <input type="text" class="form-control" name="PinCode" placeholder="Type here and search" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" onchange="ResetCommunication(this)" maxlength="10" />
                                            <div class="input-group-append">
                                                <button id="addpincode-jq-searchButton3" name="pincd" class="btn btn-primary fa fa-search" type="button" perfect-css="button" onclick="searchbtn(this)"></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-4">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-5 col-form-label">
                                        <span perfect-class="formGroupLabel">Country</span>
                                        <span class="text-danger">*</span>
                                    </label>
                                    <div class="col-sm-7">
                                        <div class="input-group">
                                            <input type="text" class="form-control " name="Country" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" disabled />
                                            <input type="hidden" name="CountryID" class="form-control perfectValidate_string" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input" min="1" />
                                            <div class="input-group-append">
                                                <button id="addcountry-jq-searchButton3" name="cntry" class="btn btn-primary fa fa-search" type="button" perfect-css="button" onclick="GetCmnPopUpSearchVal(this,9,'Country List',['','','States','StatesID','DistrictID','District','AreaID','Area','Post','PostID','PinCode'])" Criterea1="0" Criterea2="0" BindName="Country" BindVal="CountryID"></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-5 col-form-label">
                                        <span perfect-class="formGroupLabel">State</span>
                                        <span class="text-danger">*</span>
                                    </label>
                                    <div class="col-sm-7">
                                        <div class="input-group">
                                            <input type="text" class="form-control " name="States" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" disabled />
                                            <input type="hidden" name="StatesID" class="form-control perfectValidate_string" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input" min="1" />
                                            <div class="input-group-append">
                                                <button id="addstates-jq-searchButton3" name="state" class="btn btn-primary fa fa-search" type="button" perfect-css="button" onclick="GetCmnPopUpSearchVal(this,10,'State List',['CountryID','Country','DistrictID','District','AreaID','Area','Post','PostID','PinCode'])" Criterea1="CountryID" Criterea2="0" BindName="States" BindVal="StatesID"></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-4">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-5 col-form-label">
                                        <span perfect-class="formGroupLabel">District</span>
                                        <span class="text-danger">*</span>
                                    </label>
                                    <div class="col-sm-7">
                                        <div class="input-group">
                                            <input type="text" class="form-control " name="District" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" disabled />
                                            <input type="hidden" name="DistrictID" class="form-control perfectValidate_string" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input" min="1" />
                                            <div class="input-group-append">
                                                <button id="adddistrict-jq-searchButton3" name="distct" class="btn btn-primary fa fa-search" type="button" perfect-css="button" onclick="GetCmnPopUpSearchVal(this,11,'District List',['StatesID','State','AreaID','Area','Post','PostID','PinCode'])" Criterea1="StatesID" Criterea2="0" BindName="District" BindVal="DistrictID"></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-4">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-5 col-form-label">
                                        <span perfect-class="formGroupLabel">Area</span>
                                        <span class="text-danger">*</span>
                                    </label>
                                    <div class="col-sm-7">
                                        <div class="input-group">
                                            <input type="text" class="form-control " autocomplete="off" name="Area" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" maxlength="150" readonly />
                                            <input type="hidden" name="AreaID" class="form-control perfectValidate_string" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input" min="1" />
                                            <div class="input-group-append">
                                                <button id="addarea-jq-searchButton3" name="areas" class="btn btn-primary fa fa-search" type="button" perfect-css="button" form="form" onclick="GetCmnPopUpSearchVal(this,14,'Area List',['DistrictID','District','Post','PostID','PinCode'])" criterea1="DistrictID" criterea2="0" bindname="Area" bindval="AreaID"></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-4">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-5 col-form-label">
                                        <span perfect-class="formGroupLabel">Post</span>

                                    </label>
                                    <div class="col-sm-7">
                                        <div class="input-group">
                                            <input type="text" class="form-control " name="Post" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" disabled />
                                            <input type="hidden" name="PostID" class="form-control perfectValidate_numeric_nm" perfect-class="formGroupControl" perfect-ctype="hidden" perfect-css="input" />
                                            <div class="input-group-append">
                                                <button id="addpincode-jq-searchButton3" name="pst" class="btn btn-primary fa fa-search" type="button" perfect-css="button" onclick="GetCmnPopUpSearchVal(this,13,'Post List',['AreaID','Area','PinCode'])" Criterea1="AreaID" Criterea2="0" BindName="Post" BindVal="PostID"></button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-5 col-form-label">
                                        <span perfect-class="formGroupLabel">Mobile</span>
                                    </label>
                                    <div class="col-sm-7">
                                        <div class="input-group">
                                            <input type="text" class="form-control perfectValidate_mobile_nm" autocomplete="off" placeholder="" name="ShpMobile" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <hr />
                        <div class="row">
                            <div class="col-sm-6">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-5 col-form-label">
                                        <span perfect-class="formGroupLabel">Driver Name</span>

                                    </label>
                                    <div class="col-sm-7">
                                        <div class="input-group">

                                            <input type="text" class="form-control perfectValidate_string_nm psscapitalize" placeholder="" name="DrvName" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" maxlength="150" />
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-5 col-form-label">
                                        <span perfect-class="formGroupLabel">Driver Phone No</span>

                                    </label>
                                    <div class="col-sm-7">
                                        <div class="input-group">

                                            <input type="text" class="form-control perfectValidate_mobile_nm" autocomplete="off" placeholder="" name="DrvPhoneno" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />
                                        </div>

                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-5 col-form-label">Transportation Type</label>
                                    <div class="col-sm-7">
                                        <div class="input-group">
                                            <select class="form-control" name="TransportType" perfect-class="formGroupControl" perfect-ctype="select" perfect-css="select">

                                                <option value="0">Please Select</option>
                                                @if (!(Model.TransporttypeModeList is null))
                                                {
                                                    foreach (var transportList in Model.TransporttypeModeList)
                                                    {
                                                        <option value="@transportList.ID_Mode">@transportList.ModeName</option>
                                                    }
                                                }
                                            </select>


                                        </div>
                                        <div class="text-danger temptableError"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group row" perfect-class="formGroup">
                                    <label class="col-sm-5 col-form-label">
                                        <span perfect-class="formGroupLabel">Eway Bill No</span>
                                    </label>
                                    <div class="col-sm-7">
                                        <input type="text" class="form-control perfectValidate_string_nm" name="EwayBillNo" perfect-class="formGroupControl" perfect-ctype="input" perfect-css="input" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-9">
                            </div>

                        </div>

                        </div>
                    </div>
            </div>
            <div class="card-footer text-right" perfect-class="formFooter">
                @if (ViewBag.AdminManager)
                {
                    <button id="" type="button" class="btn btn-primary mr-3 addcompany-jq-addnewuserUpdate d-none" name="update" perfect-css="button" onclick="updateDeliveryAssign(this,'update')"><i class="fa fa-refresh fa-spin  loaderClass"></i>Update</button>
                }
                @if (ViewBag.PagedAccessRights.UsrrlMsAdd)
                {
                    <button id="addcompany-jq-addnewuser" type="button" class="btn btn-primary mr-3 " name="add" perfect-css="button" onclick="updateDeliveryAssign(this,'new')"><i class="fa fa-refresh fa-spin loaderClass "></i>Save</button>
                }
                <button type="button" class="btn btn-light" perfect-css="button" onclick="ResetButton(this)" name="reset">Clear</button>
            </div>
        </form>
    </div>
</div>
<script>
    (function () {
        jQuery('select').selectpicker();
    })();
    function getfunction() {
        let $thisForm = $('[perfect-class="form"]');
        if ($thisForm.find('[name="VehicleID"]').val() > 0 || $thisForm.find('[name="VehicleID"]').val() != "") {
            $thisForm.find('[name="VehicleName"]').attr("readonly",true);
        }
        else {
            $thisForm.find('[name="VehicleName"]').attr("readonly",false);
        }
    }
    function fn_showDeliveryAssignmentImportList(element) {

        let $thisForm = $(element).closest('[perfect-class="form"]');
        switch (parseInt($thisForm.find('[name="ddlImportsList"]').val())) {
            case 1:
                GetCmnPopUpSearchValAssign(element, 115, 'Sales  List', [], ['ID_Sales', 'DACustomer', 'DAReferenceNo', 'DADate', 'Mobile', 'Address']);
                break;
            case 2:
                GetCmnPopUpSearchValAssign(element, 114, 'Sales Order List', [], ['ID_SalesOrder', 'DACustomer', 'DAReferenceNo', 'DADate', 'Mobile', 'Address']);

                break;
            default:
                NotificationMessage({ 'type': 'info', 'heading': 'info', 'message': 'Please Select Import From' });
                break;
        }


    }
    function decimalpnt(ele, id, range) {
        debugger
        let input = $('#' + id);

        ele.value = ele.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');
        let t = ele.value;
        ele.value = (t.indexOf(".") >= 0) ? (t.substr(0, t.indexOf(".")) + t.substr(t.indexOf("."), range)) : t;

        $(document).on('keydown', '#' + id, function (event) {

            if (ele.value.includes('.')) {

            }
            else if (ele.value === '.' && (event.key === '.' || event.keyCode === 190)) {
                ele.value = '0.00'; // Change the value to '0.00' if only a dot is entered
                // Prevent the dot from being entered in the input field
            }
            var key = event.keyCode || event.charCode;
            if (key == 8 || key == 46) { }
            else {
                if (ele.value.indexOf('.') < 0 && ele.value.indexOf('.') !== 9 && ele.value.length > 8) {
                    ele.value = ele.value + '.';
                }
            }

        });

    }
    function getfunctionAssign(ele) {
        let $thisForm = $('[perfect-class="form"]');

        $('[name="Checkboxsame"]').prop('checked', false);
        let Importid = parseInt($thisForm.find('[name="ddlImportsList"]').val());
        let ID =0;
        if (Importid == 1) {

            ID = parseInt($thisForm.find('[name="ID_Sales"]').val());
        }
        else {
            ID = parseInt($thisForm.find('[name="ID_SalesOrder"]').val());
        }




        $('#tbodyDeliveryAssignment').empty();

        var InputData = {
            __RequestVerificationToken: $('[name="__RequestVerificationToken"]').val(),
            'ImportID': Importid,
            'ID':ID
        }

        $.ajax({
            url: "@Url.Action("GetProductDetails", "DeliveryAssignment")",
            type: "POST",
            data: InputData,
            dataType: "json",
            contentType: "application/x-www-form-urlencoded;charset=utf-8",
            success: function (ajaxOutput) {
                debugger

                console.log('ajaxOutput', ajaxOutput)


                if (ajaxOutput) {
                    $.each(ajaxOutput.Lits.Data, function (i, key) {

                        var $ProductHtml = '';                      
                        $ProductHtml = `<tr class="ProductClass">
                                        <td class="jq_checkmark"><input class="ProductChecked" type="checkbox"  id="checkmark${i}"  name="Markproduct" onchange="fn_Quantitychecking(this,${i})" value=""></td>
                                        <td class="jq_productid" style="display:none"><input type="text" id="ProductID"  value="${key.ProductID}"/></td >
                                        <td class="jq_productName">${key.Productname}</td >                                                          
                                        <td class="jq_quantityHidden" style="display:none"><input type="hidden"name="Quantity" id="Quantity${i}" value="${key.Quantity}"/></td>
                                        <td class="jq_enteredquantity"><input type="text" class="form-control" id="EnteredQuantity${i}" name="EnterQuantity" maxlength="13" oninput="decimalpnt(this,'EnteredQuantity${i}',4)" onchange="fn_Quantitychecking(this,${i})" value="${key.Quantity}"></td>`;
                        $('#tbodyDeliveryAssignment').append($ProductHtml);
                        $('#EnteredQuantity' + i).attr("disabled", true);
                    });
                    
                }
                else {
                    $.each(ajaxOutput.Process, function (i, key) {

                    });
                }
            }


        });

        $("#Checkboxsame").trigger("click");
}
    function fn_checkboxClick(ele) {

    }

    function fn_Quantitychecking(ele,i) {
        debugger
        let $thisForm = $('[perfect-class="form"]');
        let currentRow = $("#tbodyDeliveryAssignment tr");
        let qnty = $(currentRow).find('#Quantity'+i).val();
        let enteredqnty = $(currentRow).find('#EnteredQuantity'+i).val();
        debugger
        $(currentRow).find('#EnteredQuantity' + i).attr("disabled", true);
        if ($('[name="Markproduct"]').is(':checked') == true) {
            $(currentRow).find('#EnteredQuantity' + i).attr("disabled", false);
            if (parseFloat(enteredqnty) > parseFloat(qnty) || parseFloat(enteredqnty) <= 0) {
                NotificationMessage({ 'type': 'error', 'heading': 'Warning', 'message': 'Quantity should not be greater than Ordered Quantity' });
                //$(currentRow).find('#EnteredQuantity').val(qnty);
                return false;                
            }
            else {
                return true;
            }
        }
        else {
            $(currentRow).find('#EnteredQuantity' + i).attr("disabled", true);
            NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': 'Please Select Any Products ' });
            $(currentRow).find('#EnteredQuantity' + i).val(qnty);
            return false;
        }

    }
    function fn_QuantitycheckingSaveCase(ele) {
        debugger
        let $thisForm = $('[perfect-class="form"]');
       
        let currentRow = $("#tbodyDeliveryAssignment tr");
        let i = $("#tbodyDeliveryAssignment tr").index();
            let qnty = $(currentRow).find('#Quantity'+ i).val();
            let enteredqnty = $(currentRow).find('#EnteredQuantity'+ i).val();
           
            $(currentRow).find('#EnteredQuantity' + i).attr("disabled", true);
            if ($('#checkmark'+i).is(':checked') == true) {
                $(currentRow).find('#EnteredQuantity' + i).attr("disabled", false);
                if (parseFloat(enteredqnty) > parseFloat(qnty) || parseFloat(enteredqnty) <= 0) {
                    //NotificationMessage({ 'type': 'error', 'heading': 'Warning', 'message': 'Quantity should not be greater than Ordered Quantity' });
                    //$(currentRow).find('#EnteredQuantity').val(qnty);
                    qnty = 0;
                    enteredqnty = 0;
                    return false;
                   
                }
                else {
                    return true;
                }
            }
            else {
                $(currentRow).find('#EnteredQuantity' + i).attr("disabled", true);
                NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': 'Please Select Any Products ' });
                $(currentRow).find('#EnteredQuantity' + i).val(qnty);
                return false;
            }

       
    }

    function updateDeliveryAssign(element,actionType)
    {   debugger
        let $thisForm = $(element).closest('[perfect-class="form"]');
        let blnCheck = true;
        var today = new Date().toISOString().split('T')[0];
        document.getElementsByName("DeliveryDate")[0].setAttribute('min', today);
        debugger;
        if ($thisForm.valid()) {
            if ($('.ProductChecked').filter(':checked').length > 0) {
                var Deliveryassignedproductdetailsrws = $("#tbodyDeliveryAssignment tr");
                let DeliveryProductDetails = [];
                if (Deliveryassignedproductdetailsrws.length > 0) {
                    $('#tbodyDeliveryAssignment tr').each(function (index, ele) {
                        if ($(this).find('.jq_checkmark').find('[type="checkbox"]').is(':checked') == true) {
                            let qnty = $(this).find('.jq_quantityHidden').find('input').val(); 
                            let enteredqnty = $(this).find('.jq_enteredquantity').find('input').val();
                            if (parseFloat(enteredqnty) > parseFloat(qnty) || parseFloat(enteredqnty) <= 0) { 
                                blnCheck=false
                                return false;

                            }
                            else {
                                let PrDetinfo = {};
                                PrDetinfo['ProductID'] = $(this).find('.jq_productid').find('input').val();
                                PrDetinfo['Quantity'] = $(this).find('.jq_enteredquantity').find('input').val();
                                DeliveryProductDetails.push(PrDetinfo);
                            }                           
                        }
                    });
                }
                if (blnCheck) {
                    let _ID_DeliveryAssignment = 0;
                    let _ActionUrl = "";
                    if (actionType === "new") {
                        _ID_DeliveryAssignment = 0;
                        _ActionUrl = "@Url.Action("AddNewDeliveryAssignment", "DeliveryAssignment")";
                    }
                    else if (actionType === "update") {
                        _ID_DeliveryAssignment = $thisForm.find('[name="ID_DeliveryAssignment"]').val();
                        _ActionUrl = "@Url.Action("UpdateDeliveryAssignment", "DeliveryAssignment")";
                    }
                    let inputData =
                    {
                        __RequestVerificationToken: $('[name="__RequestVerificationToken"]').val(),
                        'ID_DeliveryAssignment': _ID_DeliveryAssignment,
                        'ImportID': $thisForm.find('[name="ddlImportsList"]').val(),
                        'SalesID': $thisForm.find('[name="ID_Sales"]').val(),
                        'SalesOrderID': $thisForm.find('[name="ID_SalesOrder"]').val(),
                        'ddlImportsList': $thisForm.find('[name="ddlImportsList"]').val(),
                        'VehicleID': $thisForm.find('[name="VehicleID"]').val(),
                        'Vehicleno': $thisForm.find('[name="VehicleName"]').val(),
                        'EmployeeID': $thisForm.find('[name="EmployeeID"]').val(),
                        'EwayBillNo': $thisForm.find('[name="EwayBillNo"]').val(),
                        'ProductDetails': DeliveryProductDetails,
                        'AddressCheck': $thisForm.find('[name="Checkboxsame"]').is(':Checked'),
                        'ShpContactName': $thisForm.find('[name="ShpContactName"]').val(),
                        'Address1': $thisForm.find('[name="Address1"]').val(),
                        'Place': $thisForm.find('[name="Address2"]').val(),
                        'PinCode': $thisForm.find('[name="PinCode"]').val(),
                        'CountryID': $thisForm.find('[name="CountryID"]').val(),
                        'StatesID': $thisForm.find('[name="StatesID"]').val(),
                        'DistrictID': $thisForm.find('[name="DistrictID"]').val(),
                        'AreaID': $thisForm.find('[name="AreaID"]').val(),
                        'PostID': $thisForm.find('[name="PostID"]').val(),
                        'ShpMobile': $thisForm.find('[name="ShpMobile"]').val(),
                        'TransportType': $thisForm.find('[name="TransportType"]').val(),
                        'DrvName': $thisForm.find('[name="DrvName"]').val(),
                        'DrvPhoneno': $thisForm.find('[name="DrvPhoneno"]').val(),
                        'DeliveryDate': $thisForm.find('[name="DeliveryDate"]').val(),
                        'DeliveryTime': $thisForm.find('[name="DeliveryTime"]').val(),
                        'TransMode': DeliveryAssignmentTransMode,
                    };
                    $.ajax({
                        url: _ActionUrl,
                        type: "POST",
                        data: inputData,
                        dataType: "json",
                        contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                        success: function (ajaxOutput) {
                            if (ajaxOutput.Process.IsProcess) {
                                $.each(ajaxOutput.Process.Message, function (key, value) {
                                    NotificationMessage({ 'type': 'success', 'heading': 'Success', 'message': value });
                                    $(element).prop('disabled', false);

                                    $thisForm.find('[perfect-ctype="select"]').val('').selectpicker('refresh');
                                    $thisForm.find('[perfect-ctype="input"]').val('');
                                    $thisForm.find('[perfect-ctype="date"]').val('');
                                    let onSuccess = $thisForm.attr('perfect-onFormSuccess')
                                    loadDeliveryAssignmentList(element);
                                    if (onSuccess) {
                                        window[onSuccess]();

                                    }
                                });
                            }
                            else {
                                $.each(ajaxOutput.Process.Message, function (key, value) {
                                    NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': value });
                                    $(element).prop('disabled', false);
                                });
                            }

                        },
                        complete: function () {
                            $(element).prop('disabled', false);
                        }
                    });
                }
                else {
                    NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': 'Quantity should not be greater than Ordered Quantity' });
                }
                
            }
            @*let check = fn_QuantitycheckingSaveCase();
          
           
            if (fn_QuantitycheckingSaveCase()) {


                var Deliveryassignedproductdetailsrws = $("#tbodyDeliveryAssignment tr");
                let DeliveryProductDetails = [];
                if (Deliveryassignedproductdetailsrws.length > 0) {
                    $('#tbodyDeliveryAssignment tr').each(function (index, ele) {
                        if ($(this).find('.jq_checkmark').find('[type="checkbox"]').is(':checked') == true) {
                            let PrDetinfo = {};
                            PrDetinfo['ProductID'] = $(this).find('.jq_productid').find('input').val();
                            PrDetinfo['Quantity'] = $(this).find('.jq_enteredquantity').find('input').val();
                            DeliveryProductDetails.push(PrDetinfo);
                        }

                    });
                }
               
                let _ID_DeliveryAssignment = 0;
                let _ActionUrl = "";

                if (actionType === "new") {
                    _ID_DeliveryAssignment = 0;
                    _ActionUrl = "@Url.Action("AddNewDeliveryAssignment", "DeliveryAssignment")";
                }
                else if (actionType === "update") {
                    _ID_DeliveryAssignment = $thisForm.find('[name="ID_DeliveryAssignment"]').val();
                    _ActionUrl = "@Url.Action("UpdateDeliveryAssignment", "DeliveryAssignment")";
                }


                let inputData =
                {
                    __RequestVerificationToken: $('[name="__RequestVerificationToken"]').val(),
                    'ID_DeliveryAssignment': _ID_DeliveryAssignment,
                    'ImportID': $thisForm.find('[name="ddlImportsList"]').val(),
                    'SalesID': $thisForm.find('[name="ID_Sales"]').val(),
                    'SalesOrderID': $thisForm.find('[name="ID_SalesOrder"]').val(),
                    'ddlImportsList': $thisForm.find('[name="ddlImportsList"]').val(),
                    'VehicleID': $thisForm.find('[name="VehicleID"]').val(),
                    'Vehicleno': $thisForm.find('[name="VehicleName"]').val(),
                    'EmployeeID': $thisForm.find('[name="EmployeeID"]').val(),
                    'EwayBillNo': $thisForm.find('[name="EwayBillNo"]').val(),
                    'ProductDetails': DeliveryProductDetails,
                    'AddressCheck': $thisForm.find('[name="Checkboxsame"]').is(':Checked'),
                    'ShpContactName': $thisForm.find('[name="ShpContactName"]').val(),
                    'Address1': $thisForm.find('[name="Address1"]').val(),
                    'Place': $thisForm.find('[name="Address2"]').val(),
                    'PinCode': $thisForm.find('[name="PinCode"]').val(),
                    'CountryID': $thisForm.find('[name="CountryID"]').val(),
                    'StatesID': $thisForm.find('[name="StatesID"]').val(),
                    'DistrictID': $thisForm.find('[name="DistrictID"]').val(),
                    'AreaID': $thisForm.find('[name="AreaID"]').val(),
                    'PostID': $thisForm.find('[name="PostID"]').val(),
                    'ShpMobile': $thisForm.find('[name="ShpMobile"]').val(),
                    'TransportType': $thisForm.find('[name="TransportType"]').val(),
                    'DrvName': $thisForm.find('[name="DrvName"]').val(),
                    'DrvPhoneno': $thisForm.find('[name="DrvPhoneno"]').val(),
                    'DeliveryDate': $thisForm.find('[name="DeliveryDate"]').val(),
                    'DeliveryTime': $thisForm.find('[name="DeliveryTime"]').val(),
                    'TransMode': DeliveryAssignmentTransMode,
                };


                $.ajax({
                    url: _ActionUrl,
                    type: "POST",
                    data: inputData,
                    dataType: "json",
                    contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                    success: function (ajaxOutput) {
                        if (ajaxOutput.Process.IsProcess) {
                            $.each(ajaxOutput.Process.Message, function (key, value) {
                                NotificationMessage({ 'type': 'success', 'heading': 'Success', 'message': value });
                                $(element).prop('disabled', false);

                                $thisForm.find('[perfect-ctype="select"]').val('').selectpicker('refresh');
                                $thisForm.find('[perfect-ctype="input"]').val('');
                                $thisForm.find('[perfect-ctype="date"]').val('');
                                let onSuccess = $thisForm.attr('perfect-onFormSuccess')
                                loadDeliveryAssignmentList(element);
                                if (onSuccess) {
                                    window[onSuccess]();

                                }
                            });
                        }
                        else {
                            $.each(ajaxOutput.Process.Message, function (key, value) {
                                NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': value });
                                $(element).prop('disabled', false);
                            });
                        }

                    },
                    complete: function () {
                        $(element).prop('disabled', false);
                    }
                });
            }*@
            else {
                $(element).prop('disabled', false);
                NotificationMessage({ 'type': 'error', 'heading': 'Warning', 'message': 'Please Select Any Products' });
                //if ($('[name="Markproduct"]').is(':checked') == true) {
                //    NotificationMessage({ 'type': 'error', 'heading': 'Warning', 'message': 'Please Select Any Products' });
                //}
            }

        }


    }


        function loadcustomeraddress(ele) {
            debugger
            let $thisForm = $(ele).closest('[perfect-class="form"]');
            var Id="";


            if ($thisForm.find('[name="Checkboxsame"]').is(':Checked')) {
                if ($thisForm.find('[name="ddlImportsList"]').val() == 1) {
                    Id = $thisForm.find('[name="ID_Sales"]').val();
                }
                else if ($thisForm.find('[name="ddlImportsList"]').val() == 2) {
                    Id = $thisForm.find('[name="ID_SalesOrder"]').val();
                }

                  var InputData =
                {
                    FK_Master: Id,
                      ImportId: $thisForm.find('[name="ddlImportsList"]').val()
                }
                if (Id != 0 || Id!="") {
                    $.ajax({
                        url: "@Url.Action("GetCustomerdetails", "Sales")",
                        type: "POST",
                        data: InputData,
                        dataType: "json",
                        contentType: 'application/x-www-form-urlencoded; charset=utf-8',
                        success: function (ajaxOutput) {
                            if (ajaxOutput.Process.IsProcess) {
                                console.log('ajaxOutput.Data[0]', ajaxOutput.Data[0]);
                                $thisForm.find('[name="Address1"]').val(ajaxOutput.Data)
                                $thisForm.find('[name="ShpContactName"]').val(ajaxOutput.Data[0].CusName);
                                $thisForm.find('[name="ShpMobile"]').val(ajaxOutput.Data[0].Mobile);
                                $thisForm.find('[name="Address1"]').val(ajaxOutput.Data[0].Address);
                                $thisForm.find('[name="Address2"]').val(ajaxOutput.Data[0].Address2);
                                $thisForm.find('[name="CountryID"]').val(ajaxOutput.Data[0].CountryID);
                                $thisForm.find('[name="Country"]').val(ajaxOutput.Data[0].Country);
                                $thisForm.find('[name="StatesID"]').val(ajaxOutput.Data[0].StatesID);
                                $thisForm.find('[name="States"]').val(ajaxOutput.Data[0].States);
                                $thisForm.find('[name="DistrictID"]').val(ajaxOutput.Data[0].DistrictID);
                                $thisForm.find('[name="District"]').val(ajaxOutput.Data[0].District);

                                $thisForm.find('[name="AreaID"]').val(ajaxOutput.Data[0].AreaID);
                                $thisForm.find('[name="Area"]').val(ajaxOutput.Data[0].Area);
                                $thisForm.find('[name="PostID"]').val(ajaxOutput.Data[0].PostID);
                                $thisForm.find('[name="Post"]').val(ajaxOutput.Data[0].Post);
                                $thisForm.find('[name="PinCode"]').val(ajaxOutput.Data[0].PinCode);
                            }
                            else {
                                $.each(ajaxOutput.Process.Message, function (key, value) {
                                    NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': 'No Address Records Found' });

                                });
                            }
                        },
                        complete: function () {
                            $(ele).prop('disabled', false);

                        }
                    });
                }
                else {
                    NotificationMessage({ 'type': 'error', 'heading': 'Error', 'message': 'Please Select Import From' });
                    $('[name="Checkboxsame"]').prop('checked', false);
                }
            }
            else {
                $thisForm.find('[name="ShpContactName"]').val('');
                $thisForm.find('[name="ShpMobile"]').val('');
                $thisForm.find('[name="Address1"]').val('');
                $thisForm.find('[name="Address2"]').val('');
                $thisForm.find('[name="CountryID"]').val(0);
                $thisForm.find('[name="Country"]').val('');
                $thisForm.find('[name="StatesID"]').val(0);
                $thisForm.find('[name="States"]').val('');
                $thisForm.find('[name="DistrictID"]').val(0);
                $thisForm.find('[name="District"]').val('');
                $('[name="Checkboxsame"]').prop('checked', false);
                $thisForm.find('[name="AreaID"]').val(0);
                $thisForm.find('[name="Area"]').val('');
                $thisForm.find('[name="PostID"]').val(0);
                $thisForm.find('[name="Post"]').val('');
            }
        }

    function ResetButton(ele) {
        deliveryAssignmentInitialLoad();

    }
    //**********************************************************************************************


</script>